//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_a "errors";_ae "fmt";_fg "github.com/unidoc/unipdf/v3/common";_d "github.com/unidoc/unipdf/v3/core";);func (_ag *Catalog )SetVersion (){_ag .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_d .MakeName (_ae .Sprintf ("\u0025\u0064\u002e%\u0064",_ag ._aa .Version .Major ,_ag ._aa .Version .Minor )));
};func (_bde *Document )FindCatalog ()(*Catalog ,bool ){var _addf *_d .PdfObjectDictionary ;for _ ,_gaf :=range _bde .Objects {_addfd ,_fea :=_d .GetDict (_gaf );if !_fea {continue ;};if _fcf ,_da :=_d .GetName (_addfd .Get ("\u0054\u0079\u0070\u0065"));
_da &&*_fcf =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_addf =_addfd ;break ;};};if _addf ==nil {return nil ,false ;};return &Catalog {Object :_addf ,_aa :_bde },true ;};func (_gb *Document )AddStream (stream *_d .PdfObjectStream ){for _ ,_cgc :=range _gb .Objects {if _cgc ==stream {return ;
};};_gb .Objects =append (_gb .Objects ,stream );};func (_fec *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_cd :_fec ._aa }};func (_ecf Page )GetContents ()([]Content ,bool ){_acc ,_bg :=_d .GetArray (_ecf .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_bg {_aaa ,_aaag :=_d .GetStream (_ecf .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_aaag {return nil ,false ;};return []Content {{Stream :_aaa ,_bfgf :_ecf ,_bdc :0}},true ;};_eea :=make ([]Content ,_acc .Len ());for _aba ,_fa :=range _acc .Elements (){_aebf ,_ebd :=_d .GetStream (_fa );
if !_ebd {continue ;};_eea [_aba ]=Content {Stream :_aebf ,_bfgf :_ecf ,_bdc :_aba };};return _eea ,true ;};type ImageSMask struct{Image *Image ;Stream *_d .PdfObjectStream ;};func (_bd *Catalog )GetMarkInfo ()(*_d .PdfObjectDictionary ,bool ){_dd ,_gf :=_d .GetDict (_bd .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _dd ,_gf ;};func (_age *Content )SetData (data []byte )error {_eccf ,_fed :=_d .MakeStream (data ,_d .NewFlateEncoder ());if _fed !=nil {return _fed ;};_eaef ,_baf :=_d .GetArray (_age ._bfgf .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_baf &&_age ._bdc ==0{_age ._bfgf .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_eccf );}else {if _fed =_eaef .Set (_age ._bdc ,_eccf );_fed !=nil {return _fed ;};};_age ._bfgf ._ece .Objects =append (_age ._bfgf ._ece .Objects ,_eccf );
return nil ;};func (_b *Catalog )SetMetadata (data []byte )error {_fef ,_ff :=_d .MakeStream (data ,nil );if _ff !=nil {return _ff ;};_fef .Set ("\u0054\u0079\u0070\u0065",_d .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_fef .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_d .MakeName ("\u0058\u004d\u004c"));
_b .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_fef );_b ._aa .Objects =append (_b ._aa .Objects ,_fef );return nil ;};type Page struct{_be int ;Object *_d .PdfObjectDictionary ;_ece *Document ;};func (_ad *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _ba :=_ad .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_ba !=nil {for _ee ,_ca :=range _ad ._aa .Objects {if _ca ==_ba {if outputIntents ._fbfc ==_ba {return ;};_ad ._aa .Objects =append (_ad ._aa .Objects [:_ee ],_ad ._aa .Objects [_ee +1:]...);break ;};};};_dc :=outputIntents ._fbfc ;if _dc ==nil {_dc =_d .MakeIndirectObject (outputIntents ._dcc );
};_ad .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_dc );_ad ._aa .Objects =append (_ad ._aa .Objects ,_dc );};func (_cb *OutputIntents )Add (oi _d .PdfObject )error {_add ,_ga :=oi .(*_d .PdfObjectDictionary );
if !_ga {return _a .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _dcd ,_ecg :=_d .GetStream (_add .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_ecg {_cb ._cd .Objects =append (_cb ._cd .Objects ,_dcd );};_ecd ,_fcb :=oi .(*_d .PdfIndirectObject );if !_fcb {_ecd =_d .MakeIndirectObject (oi );
};if _cb ._dcc ==nil {_cb ._dcc =_d .MakeArray (_ecd );}else {_cb ._dcc .Append (_ecd );};_cb ._cd .Objects =append (_cb ._cd .Objects ,_ecd );return nil ;};func (_eeb Page )GetResourcesXObject ()(*_d .PdfObjectDictionary ,bool ){_abf ,_gff :=_eeb .GetResources ();
if !_gff {return nil ,false ;};return _d .GetDict (_abf .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_ed *Catalog )GetStructTreeRoot ()(*_d .PdfObjectDictionary ,bool ){return _d .GetDict (_ed .Object .Get ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074"));
};func (_cg *Catalog )SetMarkInfo (mi _d .PdfObject ){if mi ==nil {_cg .Object .Remove ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f");return ;};_gg :=_d .MakeIndirectObject (mi );_cg .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_gg );
_cg ._aa .Objects =append (_cg ._aa .Objects ,_gg );};func (_gfa Page )FindXObjectImages ()([]*Image ,error ){_dda ,_gbf :=_gfa .GetResourcesXObject ();if !_gbf {return nil ,nil ;};var _dbf []*Image ;var _bdb error ;_eae :=map[*_d .PdfObjectStream ]int {};
_cef :=map[*_d .PdfObjectStream ]struct{}{};var _cab int ;for _ ,_afdd :=range _dda .Keys (){_fd ,_ffa :=_d .GetStream (_dda .Get (_afdd ));if !_ffa {continue ;};if _ ,_cbd :=_eae [_fd ];_cbd {continue ;};_ccc ,_bfg :=_d .GetName (_fd .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_bfg ||_ccc .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_bffc :=Image {BitsPerComponent :8,Stream :_fd ,Name :string (_afdd )};if _bffc .Colorspace ,_bdb =_bad (_fd .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));
_bdb !=nil {_fg .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_bdb );continue ;};if _gec ,_eeba :=_d .GetIntVal (_fd .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));
_eeba {_bffc .BitsPerComponent =_gec ;};if _gfe ,_aef :=_d .GetIntVal (_fd .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));_aef {_bffc .Width =_gfe ;};if _cbe ,_abc :=_d .GetIntVal (_fd .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));
_abc {_bffc .Height =_cbe ;};if _fcc ,_ccf :=_d .GetStream (_fd .Get ("\u0053\u004d\u0061s\u006b"));_ccf {_bffc .SMask =&ImageSMask {Image :&_bffc ,Stream :_fcc };_cef [_fcc ]=struct{}{};};switch _bffc .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_bffc .ColorComponents =3;
case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_bffc .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_bffc .ColorComponents =4;default:_bffc .ColorComponents =-1;};_eae [_fd ]=_cab ;_dbf =append (_dbf ,&_bffc );
_cab ++;};var _bga []int ;for _ ,_cbb :=range _dbf {if _cbb .SMask !=nil {_cgd ,_bb :=_eae [_cbb .SMask .Stream ];if _bb {_bga =append (_bga ,_cgd );};};};_acab :=make ([]*Image ,len (_dbf )-len (_bga ));_cab =0;_afb :for _acca ,_ffd :=range _dbf {for _ ,_cfc :=range _bga {if _acca ==_cfc {continue _afb ;
};};_acab [_cab ]=_ffd ;_cab ++;};return _dbf ,nil ;};func (_fba *Catalog )SetStructTreeRoot (structTreeRoot _d .PdfObject ){if structTreeRoot ==nil {_fba .Object .Remove ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074");
return ;};_gd :=_d .MakeIndirectObject (structTreeRoot );_fba .Object .Set ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074",_gd );_fba ._aa .Objects =append (_fba ._aa .Objects ,_gd );};type Image struct{Name string ;Width int ;
Height int ;Colorspace _d .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_d .PdfObjectStream ;};type Document struct{ID [2]string ;Version _d .Version ;Objects []_d .PdfObject ;Info _d .PdfObject ;Crypt *_d .PdfCrypt ;
UseHashBasedID bool ;};func (_ec *OutputIntents )Len ()int {return _ec ._dcc .Len ()};type OutputIntent struct{Object *_d .PdfObjectDictionary ;};func (_edb Content )GetData ()([]byte ,error ){_dac ,_cbc :=_d .NewEncoderFromStream (_edb .Stream );if _cbc !=nil {return nil ,_cbc ;
};_acb ,_cbc :=_dac .DecodeStream (_edb .Stream );if _cbc !=nil {return nil ,_cbc ;};return _acb ,nil ;};type OutputIntents struct{_dcc *_d .PdfObjectArray ;_cd *Document ;_fbfc *_d .PdfIndirectObject ;};func (_cgbg *Page )Number ()int {return _cgbg ._be };
func (_cf *Catalog )HasMetadata ()bool {_de :=_cf .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _de !=nil ;};func (_eb *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cc :=_eb .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _cc ==nil {return nil ,false ;};_dcg ,_ce :=_d .GetIndirect (_cc );if !_ce {return nil ,false ;};_df ,_ega :=_d .GetArray (_dcg .PdfObject );if !_ega {return nil ,false ;};return &OutputIntents {_fbfc :_dcg ,_dcc :_df ,_cd :_eb ._aa },true ;};func (_ge *Document )GetPages ()([]Page ,bool ){_geb ,_db :=_ge .FindCatalog ();
if !_db {return nil ,false ;};return _geb .GetPages ();};func (_cdc *Document )AddIndirectObject (indirect *_d .PdfIndirectObject ){for _ ,_bff :=range _cdc .Objects {if _bff ==indirect {return ;};};_cdc .Objects =append (_cdc .Objects ,indirect );};func (_fbfb *OutputIntents )Get (i int )(OutputIntent ,bool ){if _fbfb ._dcc ==nil {return OutputIntent {},false ;
};if i >=_fbfb ._dcc .Len (){return OutputIntent {},false ;};_cca :=_fbfb ._dcc .Get (i );_dg ,_adc :=_d .GetIndirect (_cca );if !_adc {_afe ,_ac :=_d .GetDict (_cca );return OutputIntent {Object :_afe },_ac ;};_ggf ,_bf :=_d .GetDict (_dg .PdfObject );
return OutputIntent {Object :_ggf },_bf ;};func (_fbf *Catalog )GetMetadata ()(*_d .PdfObjectStream ,bool ){return _d .GetStream (_fbf .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));};func _bad (_bc _d .PdfObject )(_d .PdfObjectName ,error ){var _dff *_d .PdfObjectName ;
var _ebf *_d .PdfObjectArray ;if _dbc ,_gac :=_bc .(*_d .PdfIndirectObject );_gac {if _deg ,_egf :=_dbc .PdfObject .(*_d .PdfObjectArray );_egf {_ebf =_deg ;}else if _aga ,_ea :=_dbc .PdfObject .(*_d .PdfObjectName );_ea {_dff =_aga ;};}else if _adb ,_ab :=_bc .(*_d .PdfObjectArray );
_ab {_ebf =_adb ;}else if _abb ,_cgcf :=_bc .(*_d .PdfObjectName );_cgcf {_dff =_abb ;};if _dff !=nil {switch *_dff {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_dff ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_dff ,nil ;};};if _ebf !=nil &&_ebf .Len ()> 0{if _ebb ,_aca :=_ebf .Get (0).(*_d .PdfObjectName );_aca {switch *_ebb {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ebf .Len ()==1{return *_ebb ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_ebb ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_ebb ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_ebb ,nil ;};};};return "",nil ;};func (_gdc Page )GetResources ()(*_d .PdfObjectDictionary ,bool ){return _d .GetDict (_gdc .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};type Content struct{Stream *_d .PdfObjectStream ;_bdc int ;_bfgf Page ;};func (_aeb *Catalog )GetPages ()([]Page ,bool ){_af ,_e :=_d .GetDict (_aeb .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_e {return nil ,false ;};_g ,_c :=_d .GetArray (_af .Get ("\u004b\u0069\u0064\u0073"));
if !_c {return nil ,false ;};_fb :=make ([]Page ,_g .Len ());for _fe ,_fc :=range _g .Elements (){_eg ,_afd :=_d .GetDict (_fc );if !_afd {continue ;};_fb [_fe ]=Page {Object :_eg ,_be :_fe +1,_ece :_aeb ._aa };};return _fb ,true ;};func (_ggfc Page )FindXObjectForms ()[]*_d .PdfObjectStream {_bbb ,_aff :=_ggfc .GetResourcesXObject ();
if !_aff {return nil ;};_ecgf :=map[*_d .PdfObjectStream ]struct{}{};var _ddg func (_cde *_d .PdfObjectDictionary ,_fga map[*_d .PdfObjectStream ]struct{});_ddg =func (_bbd *_d .PdfObjectDictionary ,_dgb map[*_d .PdfObjectStream ]struct{}){for _ ,_fbe :=range _bbd .Keys (){_deb ,_dgc :=_d .GetStream (_bbd .Get (_fbe ));
if !_dgc {continue ;};if _ ,_gad :=_dgb [_deb ];_gad {continue ;};_dag ,_acaa :=_d .GetName (_deb .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_acaa ||_dag .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_dgb [_deb ]=struct{}{};_def ,_acaa :=_d .GetDict (_deb .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
if !_acaa {continue ;};_ffb ,_cgb :=_d .GetDict (_def .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));if _cgb {_ddg (_ffb ,_dgb );};};};_ddg (_bbb ,_ecgf );var _bcg []*_d .PdfObjectStream ;for _gade :=range _ecgf {_bcg =append (_bcg ,_gade );};return _bcg ;
};type Catalog struct{Object *_d .PdfObjectDictionary ;_aa *Document ;};