//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_f "errors";_c "fmt";_a "github.com/unidoc/unipdf/v4/common";_b "github.com/unidoc/unipdf/v4/core";);func (_abf *Document )AddStream (stream *_b .PdfObjectStream ){for _ ,_agdf :=range _abf .Objects {if _agdf ==stream {return ;
};};_abf .Objects =append (_abf .Objects ,stream );};func (_eg *Catalog )GetMetadata ()(*_b .PdfObjectStream ,bool ){return _b .GetStream (_eg .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));};func (_gfb *Page )Number ()int {return _gfb ._bbf };
func (_ab *Catalog )SetMetadata (data []byte )error {_gf ,_ga :=_b .MakeStream (data ,nil );if _ga !=nil {return _ga ;};_gf .Set ("\u0054\u0079\u0070\u0065",_b .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_gf .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_b .MakeName ("\u0058\u004d\u004c"));
_ab .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_gf );_ab ._fd .Objects =append (_ab ._fd .Objects ,_gf );return nil ;};func (_fbe *Document )FindCatalog ()(*Catalog ,bool ){var _gaa *_b .PdfObjectDictionary ;for _ ,_ge :=range _fbe .Objects {_dcf ,_egd :=_b .GetDict (_ge );
if !_egd {continue ;};if _eef ,_cd :=_b .GetName (_dcf .Get ("\u0054\u0079\u0070\u0065"));_cd &&*_eef =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_gaa =_dcf ;break ;};};if _gaa ==nil {return nil ,false ;};return &Catalog {Object :_gaa ,_fd :_fbe },true ;
};func (_ddb *OutputIntents )Get (i int )(OutputIntent ,bool ){if _ddb ._eb ==nil {return OutputIntent {},false ;};if i >=_ddb ._eb .Len (){return OutputIntent {},false ;};_gbb :=_ddb ._eb .Get (i );_ddbf ,_bbe :=_b .GetIndirect (_gbb );if !_bbe {_ebb ,_fda :=_b .GetDict (_gbb );
return OutputIntent {Object :_ebb },_fda ;};_ced ,_cf :=_b .GetDict (_ddbf .PdfObject );return OutputIntent {Object :_ced },_cf ;};func (_ece *Document )GetPages ()([]Page ,bool ){_dad ,_aed :=_ece .FindCatalog ();if !_aed {return nil ,false ;};return _dad .GetPages ();
};func (_cdad *Document )AddIndirectObject (indirect *_b .PdfIndirectObject ){for _ ,_ea :=range _cdad .Objects {if _ea ==indirect {return ;};};_cdad .Objects =append (_cdad .Objects ,indirect );};func _bac (_fc _b .PdfObject )(_b .PdfObjectName ,error ){var _fe *_b .PdfObjectName ;
var _gc *_b .PdfObjectArray ;if _ggd ,_ca :=_fc .(*_b .PdfIndirectObject );_ca {if _gaaa ,_ebg :=_ggd .PdfObject .(*_b .PdfObjectArray );_ebg {_gc =_gaaa ;}else if _aea ,_dcg :=_ggd .PdfObject .(*_b .PdfObjectName );_dcg {_fe =_aea ;};}else if _dca ,_adad :=_fc .(*_b .PdfObjectArray );
_adad {_gc =_dca ;}else if _fee ,_ebe :=_fc .(*_b .PdfObjectName );_ebe {_fe =_fee ;};if _fe !=nil {switch *_fe {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_fe ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_fe ,nil ;};};if _gc !=nil &&_gc .Len ()> 0{if _ffa ,_bad :=_gc .Get (0).(*_b .PdfObjectName );_bad {switch *_ffa {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _gc .Len ()==1{return *_ffa ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_ffa ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_ffa ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_ffa ,nil ;};};};return "",nil ;};func (_gdaf Page )FindXObjectImages ()([]*Image ,error ){_ffc ,_edb :=_gdaf .GetResourcesXObject ();if !_edb {return nil ,nil ;
};var _cg []*Image ;var _cef error ;_gcd :=map[*_b .PdfObjectStream ]int {};_fa :=map[*_b .PdfObjectStream ]struct{}{};var _gga int ;for _ ,_ef :=range _ffc .Keys (){_baf ,_bacf :=_b .GetStream (_ffc .Get (_ef ));if !_bacf {continue ;};if _ ,_ade :=_gcd [_baf ];
_ade {continue ;};_feee ,_efd :=_b .GetName (_baf .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_efd ||_feee .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_aafc :=Image {BitsPerComponent :8,Stream :_baf ,Name :string (_ef )};if _aafc .Colorspace ,_cef =_bac (_baf .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));
_cef !=nil {_a .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_cef );continue ;};if _cfa ,_dda :=_b .GetIntVal (_baf .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));
_dda {_aafc .BitsPerComponent =_cfa ;};if _ebf ,_bg :=_b .GetIntVal (_baf .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));_bg {_aafc .Width =_ebf ;};if _gfed ,_gffa :=_b .GetIntVal (_baf .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));
_gffa {_aafc .Height =_gfed ;};if _cae ,_eff :=_b .GetStream (_baf .Get ("\u0053\u004d\u0061s\u006b"));_eff {_aafc .SMask =&ImageSMask {Image :&_aafc ,Stream :_cae };_fa [_cae ]=struct{}{};};switch _aafc .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_aafc .ColorComponents =3;
case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_aafc .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_aafc .ColorComponents =4;default:_aafc .ColorComponents =-1;};_gcd [_baf ]=_gga ;_cg =append (_cg ,&_aafc );
_gga ++;};var _cea []int ;for _ ,_aede :=range _cg {if _aede .SMask !=nil {_fea ,_df :=_gcd [_aede .SMask .Stream ];if _df {_cea =append (_cea ,_fea );};};};_feg :=make ([]*Image ,len (_cg )-len (_cea ));_gga =0;_edg :for _bdb ,_fed :=range _cg {for _ ,_ebfc :=range _cea {if _bdb ==_ebfc {continue _edg ;
};};_feg [_gga ]=_fed ;_gga ++;};return _cg ,nil ;};func (_abg *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _ae :=_abg .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");_ae !=nil {for _da ,_agd :=range _abg ._fd .Objects {if _agd ==_ae {if outputIntents ._afea ==_ae {return ;
};_abg ._fd .Objects =append (_abg ._fd .Objects [:_da ],_abg ._fd .Objects [_da +1:]...);break ;};};};_aa :=outputIntents ._afea ;if _aa ==nil {_aa =_b .MakeIndirectObject (outputIntents ._eb );};_abg .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_aa );
_abg ._fd .Objects =append (_abg ._fd .Objects ,_aa );};func (_bb *Catalog )GetStructTreeRoot ()(*_b .PdfObjectDictionary ,bool ){return _b .GetDict (_bb .Object .Get ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074"));
};type Content struct{Stream *_b .PdfObjectStream ;_dcd int ;_dgf Page ;};func (_db *Catalog )GetMarkInfo ()(*_b .PdfObjectDictionary ,bool ){_ce ,_cb :=_b .GetDict (_db .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));return _ce ,_cb ;
};func (_cee Page )GetContents ()([]Content ,bool ){_eeb ,_fcg :=_b .GetArray (_cee .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_fcg {_aaf ,_gff :=_b .GetStream (_cee .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_gff {return nil ,false ;};return []Content {{Stream :_aaf ,_dgf :_cee ,_dcd :0}},true ;};_add :=make ([]Content ,_eeb .Len ());for _gaad ,_ddd :=range _eeb .Elements (){_fdd ,_edc :=_b .GetStream (_ddd );if !_edc {continue ;};_add [_gaad ]=Content {Stream :_fdd ,_dgf :_cee ,_dcd :_gaad };
};return _add ,true ;};func (_gda *Catalog )HasMetadata ()bool {_de :=_gda .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _de !=nil ;};type Catalog struct{Object *_b .PdfObjectDictionary ;_fd *Document ;};func (_fb *Catalog )SetStructTreeRoot (structTreeRoot _b .PdfObject ){if structTreeRoot ==nil {_fb .Object .Remove ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074");
return ;};_bd :=_b .MakeIndirectObject (structTreeRoot );_fb .Object .Set ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074",_bd );_fb ._fd .Objects =append (_fb ._fd .Objects ,_bd );};func (_ggc Content )GetData ()([]byte ,error ){_acg ,_gcde :=_b .NewEncoderFromStream (_ggc .Stream );
if _gcde !=nil {return nil ,_gcde ;};_dcae ,_gcde :=_acg .DecodeStream (_ggc .Stream );if _gcde !=nil {return nil ,_gcde ;};return _dcae ,nil ;};type OutputIntents struct{_eb *_b .PdfObjectArray ;_ggf *Document ;_afea *_b .PdfIndirectObject ;};func (_ee *OutputIntents )Len ()int {return _ee ._eb .Len ()};
type Document struct{ID [2]string ;Version _b .Version ;Objects []_b .PdfObject ;Info _b .PdfObject ;Crypt *_b .PdfCrypt ;UseHashBasedID bool ;};func (_ffd *Content )SetData (data []byte )error {_dea ,_bgd :=_b .MakeStream (data ,_b .NewFlateEncoder ());
if _bgd !=nil {return _bgd ;};_fec ,_dfe :=_b .GetArray (_ffd ._dgf .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_dfe &&_ffd ._dcd ==0{_ffd ._dgf .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_dea );}else {if _bgd =_fec .Set (_ffd ._dcd ,_dea );
_bgd !=nil {return _bgd ;};};_ffd ._dgf ._gdc .Objects =append (_ffd ._dgf ._gdc .Objects ,_dea );return nil ;};func (_ada *OutputIntents )Add (oi _b .PdfObject )error {_ec ,_egf :=oi .(*_b .PdfObjectDictionary );if !_egf {return _f .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _gde ,_aaa :=_b .GetStream (_ec .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_aaa {_ada ._ggf .Objects =append (_ada ._ggf .Objects ,_gde );};_dgg ,_afg :=oi .(*_b .PdfIndirectObject );
if !_afg {_dgg =_b .MakeIndirectObject (oi );};if _ada ._eb ==nil {_ada ._eb =_b .MakeArray (_dgg );}else {_ada ._eb .Append (_dgg );};_ada ._ggf .Objects =append (_ada ._ggf .Objects ,_dgg );return nil ;};type OutputIntent struct{Object *_b .PdfObjectDictionary ;
};func (_cac Page )FindXObjectForms ()[]*_b .PdfObjectStream {_aca ,_fab :=_cac .GetResourcesXObject ();if !_fab {return nil ;};_feab :=map[*_b .PdfObjectStream ]struct{}{};var _gfg func (_cge *_b .PdfObjectDictionary ,_dba map[*_b .PdfObjectStream ]struct{});
_gfg =func (_fg *_b .PdfObjectDictionary ,_bgc map[*_b .PdfObjectStream ]struct{}){for _ ,_cgc :=range _fg .Keys (){_cde ,_cc :=_b .GetStream (_fg .Get (_cgc ));if !_cc {continue ;};if _ ,_cgf :=_bgc [_cde ];_cgf {continue ;};_acf ,_cfd :=_b .GetName (_cde .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_cfd ||_acf .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_bgc [_cde ]=struct{}{};_cadd ,_cfd :=_b .GetDict (_cde .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_cfd {continue ;};_gbf ,_dfc :=_b .GetDict (_cadd .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _dfc {_gfg (_gbf ,_bgc );};};};_gfg (_aca ,_feab );var _gbe []*_b .PdfObjectStream ;for _fgg :=range _feab {_gbe =append (_gbe ,_fgg );};return _gbe ;};func (_afc Page )GetResourcesXObject ()(*_b .PdfObjectDictionary ,bool ){_cdc ,_aeb :=_afc .GetResources ();
if !_aeb {return nil ,false ;};return _b .GetDict (_cdc .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};type Page struct{_bbf int ;Object *_b .PdfObjectDictionary ;_gdc *Document ;};func (_af *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_ggf :_af ._fd }};
func (_gd *Catalog )GetPages ()([]Page ,bool ){_dc ,_ag :=_b .GetDict (_gd .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_ag {return nil ,false ;};_dd ,_dg :=_b .GetArray (_dc .Get ("\u004b\u0069\u0064\u0073"));if !_dg {return nil ,false ;};_ad :=make ([]Page ,_dd .Len ());
for _ff ,_gg :=range _dd .Elements (){_e ,_ed :=_b .GetDict (_gg );if !_ed {continue ;};_ad [_ff ]=Page {Object :_e ,_bbf :_ff +1,_gdc :_gd ._fd };};return _ad ,true ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _b .PdfObjectName ;
ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_b .PdfObjectStream ;};func (_gb *Catalog )SetMarkInfo (mi _b .PdfObject ){if mi ==nil {_gb .Object .Remove ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f");return ;};_gfe :=_b .MakeIndirectObject (mi );
_gb .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_gfe );_gb ._fd .Objects =append (_gb ._fd .Objects ,_gfe );};func (_bdd *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cec :=_bdd .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _cec ==nil {return nil ,false ;};_ac ,_eda :=_b .GetIndirect (_cec );if !_eda {return nil ,false ;};_ba ,_afe :=_b .GetArray (_ac .PdfObject );if !_afe {return nil ,false ;};return &OutputIntents {_afea :_ac ,_eb :_ba ,_ggf :_bdd ._fd },true ;};type ImageSMask struct{Image *Image ;
Stream *_b .PdfObjectStream ;};func (_g *Catalog )SetVersion (){_g .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_b .MakeName (_c .Sprintf ("\u0025\u0064\u002e%\u0064",_g ._fd .Version .Major ,_g ._fd .Version .Minor )));};func (_cad Page )GetResources ()(*_b .PdfObjectDictionary ,bool ){return _b .GetDict (_cad .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};