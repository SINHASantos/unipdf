//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_f "errors";_fd "fmt";_g "github.com/unidoc/unipdf/v3/common";_d "github.com/unidoc/unipdf/v3/core";);func (_ag *Catalog )SetVersion (){_ag .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_d .MakeName (_fd .Sprintf ("\u0025\u0064\u002e%\u0064",_ag ._a .Version .Major ,_ag ._a .Version .Minor )));
};type Document struct{ID [2]string ;Version _d .Version ;Objects []_d .PdfObject ;Info _d .PdfObject ;Crypt *_d .PdfCrypt ;UseHashBasedID bool ;};func (_bb *OutputIntents )Get (i int )(OutputIntent ,bool ){if _bb ._db ==nil {return OutputIntent {},false ;
};if i >=_bb ._db .Len (){return OutputIntent {},false ;};_deb :=_bb ._db .Get (i );_bfb ,_afbe :=_d .GetIndirect (_deb );if !_afbe {_bcd ,_adb :=_d .GetDict (_deb );return OutputIntent {Object :_bcd },_adb ;};_gba ,_fbg :=_d .GetDict (_bfb .PdfObject );
return OutputIntent {Object :_gba },_fbg ;};func (_bg *Catalog )SetMarkInfo (mi _d .PdfObject ){if mi ==nil {_bg .Object .Remove ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f");return ;};_dcc :=_d .MakeIndirectObject (mi );_bg .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_dcc );
_bg ._a .Objects =append (_bg ._a .Objects ,_dcc );};type Image struct{Name string ;Width int ;Height int ;Colorspace _d .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_d .PdfObjectStream ;};func (_edb *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _eg :=_edb .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_eg !=nil {for _fe ,_fc :=range _edb ._a .Objects {if _fc ==_eg {if outputIntents ._fdg ==_eg {return ;};_edb ._a .Objects =append (_edb ._a .Objects [:_fe ],_edb ._a .Objects [_fe +1:]...);break ;};};};_ea :=outputIntents ._fdg ;if _ea ==nil {_ea =_d .MakeIndirectObject (outputIntents ._db );
};_edb .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_ea );_edb ._a .Objects =append (_edb ._a .Objects ,_ea );};type OutputIntent struct{Object *_d .PdfObjectDictionary ;};func (_gbb Page )GetContents ()([]Content ,bool ){_gfc ,_ga :=_d .GetArray (_gbb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_ga {_ddge ,_bdg :=_d .GetStream (_gbb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_bdg {return nil ,false ;};return []Content {{Stream :_ddge ,_caa :_gbb ,_dgb :0}},true ;};_ede :=make ([]Content ,_gfc .Len ());for _bba ,_aecb :=range _gfc .Elements (){_afa ,_efa :=_d .GetStream (_aecb );
if !_efa {continue ;};_ede [_bba ]=Content {Stream :_afa ,_caa :_gbb ,_dgb :_bba };};return _ede ,true ;};func (_gb *Catalog )GetMarkInfo ()(*_d .PdfObjectDictionary ,bool ){_agg ,_ae :=_d .GetDict (_gb .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _agg ,_ae ;};func (_bdb Page )FindXObjectImages ()([]*Image ,error ){_ege ,_bbf :=_bdb .GetResourcesXObject ();if !_bbf {return nil ,nil ;};var _dbf []*Image ;var _dcf error ;_abe :=map[*_d .PdfObjectStream ]int {};_dcb :=map[*_d .PdfObjectStream ]struct{}{};
var _bde int ;for _ ,_dab :=range _ege .Keys (){_daa ,_cge :=_d .GetStream (_ege .Get (_dab ));if !_cge {continue ;};if _ ,_dbg :=_abe [_daa ];_dbg {continue ;};_cadf ,_fg :=_d .GetName (_daa .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_fg ||_cadf .String ()!="\u0049\u006d\u0061g\u0065"{continue ;
};_fac :=Image {BitsPerComponent :8,Stream :_daa ,Name :string (_dab )};if _fac .Colorspace ,_dcf =_baa (_daa .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_dcf !=nil {_g .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_dcf );
continue ;};if _dde ,_dfd :=_d .GetIntVal (_daa .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_dfd {_fac .BitsPerComponent =_dde ;};if _agd ,_bcg :=_d .GetIntVal (_daa .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_bcg {_fac .Width =_agd ;};if _edg ,_fce :=_d .GetIntVal (_daa .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_fce {_fac .Height =_edg ;};if _gce ,_fbd :=_d .GetStream (_daa .Get ("\u0053\u004d\u0061s\u006b"));_fbd {_fac .SMask =&ImageSMask {Image :&_fac ,Stream :_gce };
_dcb [_gce ]=struct{}{};};switch _fac .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_fac .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_fac .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_fac .ColorComponents =4;
default:_fac .ColorComponents =-1;};_abe [_daa ]=_bde ;_dbf =append (_dbf ,&_fac );_bde ++;};var _gbg []int ;for _ ,_cd :=range _dbf {if _cd .SMask !=nil {_gca ,_bbae :=_abe [_cd .SMask .Stream ];if _bbae {_gbg =append (_gbg ,_gca );};};};_bdf :=make ([]*Image ,len (_dbf )-len (_gbg ));
_bde =0;_bff :for _dbga ,_bgc :=range _dbf {for _ ,_edd :=range _gbg {if _dbga ==_edd {continue _bff ;};};_bdf [_bde ]=_bgc ;_bde ++;};return _dbf ,nil ;};func (_ab *Document )FindCatalog ()(*Catalog ,bool ){var _dga *_d .PdfObjectDictionary ;for _ ,_bfc :=range _ab .Objects {_eb ,_ebg :=_d .GetDict (_bfc );
if !_ebg {continue ;};if _dd ,_be :=_d .GetName (_eb .Get ("\u0054\u0079\u0070\u0065"));_be &&*_dd =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_dga =_eb ;break ;};};if _dga ==nil {return nil ,false ;};return &Catalog {Object :_dga ,_a :_ab },true ;};func (_ccc *OutputIntents )Add (oi _d .PdfObject )error {_ef ,_ad :=oi .(*_d .PdfObjectDictionary );
if !_ad {return _f .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _cefb ,_gc :=_d .GetStream (_ef .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_gc {_ccc ._bca .Objects =append (_ccc ._bca .Objects ,_cefb );};_dg ,_gbd :=oi .(*_d .PdfIndirectObject );
if !_gbd {_dg =_d .MakeIndirectObject (oi );};if _ccc ._db ==nil {_ccc ._db =_d .MakeArray (_dg );}else {_ccc ._db .Append (_dg );};_ccc ._bca .Objects =append (_ccc ._bca .Objects ,_dg );return nil ;};func (_gf *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_fb :=_gf .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _fb ==nil {return nil ,false ;};_de ,_bf :=_d .GetIndirect (_fb );if !_bf {return nil ,false ;};_ced ,_ac :=_d .GetArray (_de .PdfObject );if !_ac {return nil ,false ;};return &OutputIntents {_fdg :_de ,_db :_ced ,_bca :_gf ._a },true ;};func (_ed *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_bca :_ed ._a }};
func (_cf *Catalog )GetPages ()([]Page ,bool ){_af ,_ca :=_d .GetDict (_cf .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_ca {return nil ,false ;};_gd ,_ce :=_d .GetArray (_af .Get ("\u004b\u0069\u0064\u0073"));if !_ce {return nil ,false ;};_dc :=make ([]Page ,_gd .Len ());
for _cad ,_e :=range _gd .Elements (){_ec ,_cc :=_d .GetDict (_e );if !_cc {continue ;};_dc [_cad ]=Page {Object :_ec ,_fef :_cad +1,_fcf :_cf ._a };};return _dc ,true ;};func (_aec *Document )AddIndirectObject (indirect *_d .PdfIndirectObject ){for _ ,_caf :=range _aec .Objects {if _caf ==indirect {return ;
};};_aec .Objects =append (_aec .Objects ,indirect );};type ImageSMask struct{Image *Image ;Stream *_d .PdfObjectStream ;};func (_da *Catalog )GetMetadata ()(*_d .PdfObjectStream ,bool ){_cfd ,_cef :=_d .GetStream (_da .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
return _cfd ,_cef ;};type OutputIntents struct{_db *_d .PdfObjectArray ;_bca *Document ;_fdg *_d .PdfIndirectObject ;};func (_cac Page )GetResourcesXObject ()(*_d .PdfObjectDictionary ,bool ){_ddgg ,_bae :=_cac .GetResources ();if !_bae {return nil ,false ;
};return _d .GetDict (_ddgg .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_bbfc Page )FindXObjectForms ()[]*_d .PdfObjectStream {_dce ,_bad :=_bbfc .GetResourcesXObject ();if !_bad {return nil ;};_ge :=map[*_d .PdfObjectStream ]struct{}{};var _dea func (_fdb *_d .PdfObjectDictionary ,_dfg map[*_d .PdfObjectStream ]struct{});
_dea =func (_aecf *_d .PdfObjectDictionary ,_cec map[*_d .PdfObjectStream ]struct{}){for _ ,_cdc :=range _aecf .Keys (){_gfb ,_bdc :=_d .GetStream (_aecf .Get (_cdc ));if !_bdc {continue ;};if _ ,_cb :=_cec [_gfb ];_cb {continue ;};_fee ,_cag :=_d .GetName (_gfb .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_cag ||_fee .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_cec [_gfb ]=struct{}{};_gcc ,_cag :=_d .GetDict (_gfb .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_cag {continue ;};_gab ,_cecb :=_d .GetDict (_gcc .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _cecb {_dea (_gab ,_cec );};};};_dea (_dce ,_ge );var _bcab []*_d .PdfObjectStream ;for _ecb :=range _ge {_bcab =append (_bcab ,_ecb );};return _bcab ;};type Page struct{_fef int ;Object *_d .PdfObjectDictionary ;_fcf *Document ;};func (_bdba *Content )SetData (data []byte )error {_dec ,_cea :=_d .MakeStream (data ,_d .NewFlateEncoder ());
if _cea !=nil {return _cea ;};_aa ,_feed :=_d .GetArray (_bdba ._caa .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_feed &&_bdba ._dgb ==0{_bdba ._caa .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_dec );}else {if _cea =_aa .Set (_bdba ._dgb ,_dec );
_cea !=nil {return _cea ;};};_bdba ._caa ._fcf .Objects =append (_bdba ._caa ._fcf .Objects ,_dec );return nil ;};func (_gff Content )GetData ()([]byte ,error ){_dee ,_bdec :=_d .NewEncoderFromStream (_gff .Stream );if _bdec !=nil {return nil ,_bdec ;};
_dac ,_bdec :=_dee .DecodeStream (_gff .Stream );if _bdec !=nil {return nil ,_bdec ;};return _dac ,nil ;};type Content struct{Stream *_d .PdfObjectStream ;_dgb int ;_caa Page ;};func _baa (_afc _d .PdfObject )(_d .PdfObjectName ,error ){var _fa *_d .PdfObjectName ;
var _ccf *_d .PdfObjectArray ;if _egc ,_gfe :=_afc .(*_d .PdfIndirectObject );_gfe {if _fcg ,_deg :=_egc .PdfObject .(*_d .PdfObjectArray );_deg {_ccf =_fcg ;}else if _cfb ,_df :=_egc .PdfObject .(*_d .PdfObjectName );_df {_fa =_cfb ;};}else if _ddg ,_cg :=_afc .(*_d .PdfObjectArray );
_cg {_ccf =_ddg ;}else if _dba ,_aff :=_afc .(*_d .PdfObjectName );_aff {_fa =_dba ;};if _fa !=nil {switch *_fa {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_fa ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_fa ,nil ;};};if _ccf !=nil &&_ccf .Len ()> 0{if _ada ,_bcb :=_ccf .Get (0).(*_d .PdfObjectName );_bcb {switch *_ada {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ccf .Len ()==1{return *_ada ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_ada ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_ada ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_ada ,nil ;};};};return "",nil ;};type Catalog struct{Object *_d .PdfObjectDictionary ;_a *Document ;};func (_bgd *Document )GetPages ()([]Page ,bool ){_ebb ,_ba :=_bgd .FindCatalog ();
if !_ba {return nil ,false ;};return _ebb .GetPages ();};func (_aeg *Page )Number ()int {return _aeg ._fef };func (_agb *OutputIntents )Len ()int {return _agb ._db .Len ()};func (_afg *Catalog )HasMetadata ()bool {_afb :=_afg .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _afb !=nil ;};func (_ff Page )GetResources ()(*_d .PdfObjectDictionary ,bool ){return _d .GetDict (_ff .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));};func (_fba *Document )AddStream (stream *_d .PdfObjectStream ){for _ ,_dda :=range _fba .Objects {if _dda ==stream {return ;
};};_fba .Objects =append (_fba .Objects ,stream );};func (_b *Catalog )SetMetadata (data []byte )error {_bc ,_dca :=_d .MakeStream (data ,nil );if _dca !=nil {return _dca ;};_bc .Set ("\u0054\u0079\u0070\u0065",_d .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
_bc .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_d .MakeName ("\u0058\u004d\u004c"));_b .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_bc );_b ._a .Objects =append (_b ._a .Objects ,_bc );return nil ;};