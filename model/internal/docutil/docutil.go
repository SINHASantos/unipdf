//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_d "errors";_c "fmt";_f "github.com/unidoc/unipdf/v4/common";_a "github.com/unidoc/unipdf/v4/core";);func (_edf Page )GetResourcesXObject ()(*_a .PdfObjectDictionary ,bool ){_cbe ,_ega :=_edf .GetResources ();if !_ega {return nil ,false ;
};return _a .GetDict (_cbe .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_edb Page )GetContents ()([]Content ,bool ){_gdeb ,_cad :=_a .GetArray (_edb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_cad {_ecb ,_cffa :=_a .GetStream (_edb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_cffa {return nil ,false ;};return []Content {{Stream :_ecb ,_eef :_edb ,_deg :0}},true ;};_bg :=make ([]Content ,_gdeb .Len ());for _dga ,_fd :=range _gdeb .Elements (){_gfg ,_bbf :=_a .GetStream (_fd );if !_bbf {continue ;};_bg [_dga ]=Content {Stream :_gfg ,_eef :_edb ,_deg :_dga };
};return _bg ,true ;};func (_gd *Catalog )GetStructTreeRoot ()(*_a .PdfObjectDictionary ,bool ){return _a .GetDict (_gd .Object .Get ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074"));};func (_cb *Document )FindCatalog ()(*Catalog ,bool ){var _ggb *_a .PdfObjectDictionary ;
for _ ,_afg :=range _cb .Objects {_ac ,_aac :=_a .GetDict (_afg );if !_aac {continue ;};if _fed ,_afa :=_a .GetName (_ac .Get ("\u0054\u0079\u0070\u0065"));_afa &&*_fed =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_ggb =_ac ;break ;};};if _ggb ==nil {return nil ,false ;
};return &Catalog {Object :_ggb ,_e :_cb },true ;};func (_dfge Page )GetResources ()(*_a .PdfObjectDictionary ,bool ){return _a .GetDict (_dfge .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));};func (_ge *Catalog )SetStructTreeRoot (structTreeRoot _a .PdfObject ){if structTreeRoot ==nil {_ge .Object .Remove ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074");
return ;};_fec :=_a .MakeIndirectObject (structTreeRoot );_ge .Object .Set ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074",_fec );_ge ._e .Objects =append (_ge ._e .Objects ,_fec );};type Document struct{ID [2]string ;
Version _a .Version ;Objects []_a .PdfObject ;Info _a .PdfObject ;Crypt *_a .PdfCrypt ;UseHashBasedID bool ;};func (_ffd Page )FindXObjectImages ()([]*Image ,error ){_aag ,_adb :=_ffd .GetResourcesXObject ();if !_adb {return nil ,nil ;};var _cee []*Image ;
var _gbe error ;_fbgc :=map[*_a .PdfObjectStream ]int {};_ced :=map[*_a .PdfObjectStream ]struct{}{};var _eab int ;for _ ,_dfa :=range _aag .Keys (){_geb ,_fcd :=_a .GetStream (_aag .Get (_dfa ));if !_fcd {continue ;};if _ ,_dc :=_fbgc [_geb ];_dc {continue ;
};_fdc ,_cga :=_a .GetName (_geb .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_cga ||_fdc .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_fcc :=Image {BitsPerComponent :8,Stream :_geb ,Name :string (_dfa )};if _fcc .Colorspace ,_gbe =_age (_geb .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));
_gbe !=nil {_f .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_gbe );continue ;};if _efa ,_gee :=_a .GetIntVal (_geb .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));
_gee {_fcc .BitsPerComponent =_efa ;};if _ee ,_dce :=_a .GetIntVal (_geb .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));_dce {_fcc .Width =_ee ;};if _bfd ,_ffb :=_a .GetIntVal (_geb .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));
_ffb {_fcc .Height =_bfd ;};if _caf ,_cbd :=_a .GetStream (_geb .Get ("\u0053\u004d\u0061s\u006b"));_cbd {_fcc .SMask =&ImageSMask {Image :&_fcc ,Stream :_caf };_ced [_caf ]=struct{}{};};switch _fcc .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_fcc .ColorComponents =3;
case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_fcc .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_fcc .ColorComponents =4;default:_fcc .ColorComponents =-1;};_fbgc [_geb ]=_eab ;_cee =append (_cee ,&_fcc );
_eab ++;};var _fac []int ;for _ ,_eff :=range _cee {if _eff .SMask !=nil {_fef ,_gge :=_fbgc [_eff .SMask .Stream ];if _gge {_fac =append (_fac ,_fef );};};};_edba :=make ([]*Image ,len (_cee )-len (_fac ));_eab =0;_ggg :for _cd ,_fafc :=range _cee {for _ ,_fbc :=range _fac {if _cd ==_fbc {continue _ggg ;
};};_edba [_eab ]=_fafc ;_eab ++;};return _cee ,nil ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _a .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_a .PdfObjectStream ;};func (_de *Catalog )HasMetadata ()bool {_ggf :=_de .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _ggf !=nil ;};func (_bbc *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _dd :=_bbc .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");_dd !=nil {for _be ,_cc :=range _bbc ._e .Objects {if _cc ==_dd {if outputIntents ._ga ==_dd {return ;
};_bbc ._e .Objects =append (_bbc ._e .Objects [:_be ],_bbc ._e .Objects [_be +1:]...);break ;};};};_beb :=outputIntents ._ga ;if _beb ==nil {_beb =_a .MakeIndirectObject (outputIntents ._bec );};_bbc .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_beb );
_bbc ._e .Objects =append (_bbc ._e .Objects ,_beb );};func (_ebd Page )FindXObjectForms ()[]*_a .PdfObjectStream {_bbb ,_da :=_ebd .GetResourcesXObject ();if !_da {return nil ;};_fdd :=map[*_a .PdfObjectStream ]struct{}{};var _egaa func (_dfe *_a .PdfObjectDictionary ,_aae map[*_a .PdfObjectStream ]struct{});
_egaa =func (_acb *_a .PdfObjectDictionary ,_aea map[*_a .PdfObjectStream ]struct{}){for _ ,_dab :=range _acb .Keys (){_aga ,_cba :=_a .GetStream (_acb .Get (_dab ));if !_cba {continue ;};if _ ,_bgb :=_aea [_aga ];_bgb {continue ;};_fgd ,_aaf :=_a .GetName (_aga .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_aaf ||_fgd .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_aea [_aga ]=struct{}{};_feae ,_aaf :=_a .GetDict (_aga .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_aaf {continue ;};_daf ,_ecef :=_a .GetDict (_feae .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _ecef {_egaa (_daf ,_aea );};};};_egaa (_bbb ,_fdd );var _bef []*_a .PdfObjectStream ;for _ab :=range _fdd {_bef =append (_bef ,_ab );};return _bef ;};func (_gc *Catalog )SetVersion (){_gc .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_a .MakeName (_c .Sprintf ("\u0025\u0064\u002e%\u0064",_gc ._e .Version .Major ,_gc ._e .Version .Minor )));
};type OutputIntent struct{Object *_a .PdfObjectDictionary ;};func (_cg *OutputIntents )Get (i int )(OutputIntent ,bool ){if _cg ._bec ==nil {return OutputIntent {},false ;};if i >=_cg ._bec .Len (){return OutputIntent {},false ;};_bc :=_cg ._bec .Get (i );
_ebf ,_dgd :=_a .GetIndirect (_bc );if !_dgd {_cff ,_gde :=_a .GetDict (_bc );return OutputIntent {Object :_cff },_gde ;};_ebe ,_fbg :=_a .GetDict (_ebf .PdfObject );return OutputIntent {Object :_ebe },_fbg ;};func (_gag *OutputIntents )Add (oi _a .PdfObject )error {_eg ,_fc :=oi .(*_a .PdfObjectDictionary );
if !_fc {return _d .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _fge ,_faf :=_a .GetStream (_eg .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_faf {_gag ._agc .Objects =append (_gag ._agc .Objects ,_fge );};_adg ,_dfg :=oi .(*_a .PdfIndirectObject );
if !_dfg {_adg =_a .MakeIndirectObject (oi );};if _gag ._bec ==nil {_gag ._bec =_a .MakeArray (_adg );}else {_gag ._bec .Append (_adg );};_gag ._agc .Objects =append (_gag ._agc .Objects ,_adg );return nil ;};func (_ddf *Document )GetPages ()([]Page ,bool ){_ecdd ,_edg :=_ddf .FindCatalog ();
if !_edg {return nil ,false ;};return _ecdd .GetPages ();};func (_faa *Document )AddIndirectObject (indirect *_a .PdfIndirectObject ){for _ ,_cfg :=range _faa .Objects {if _cfg ==indirect {return ;};};_faa .Objects =append (_faa .Objects ,indirect );};
func (_ea *Catalog )GetMetadata ()(*_a .PdfObjectStream ,bool ){return _a .GetStream (_ea .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));};func (_bce *Document )AddStream (stream *_a .PdfObjectStream ){for _ ,_fbb :=range _bce .Objects {if _fbb ==stream {return ;
};};_bce .Objects =append (_bce .Objects ,stream );};func (_gcf *Page )Number ()int {return _gcf ._bf };func (_ec *Catalog )GetMarkInfo ()(*_a .PdfObjectDictionary ,bool ){_cf ,_eb :=_a .GetDict (_ec .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _cf ,_eb ;};func (_ebb *Content )SetData (data []byte )error {_dgde ,_ggef :=_a .MakeStream (data ,_a .NewFlateEncoder ());if _ggef !=nil {return _ggef ;};_edgg ,_aad :=_a .GetArray (_ebb ._eef .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_aad &&_ebb ._deg ==0{_ebb ._eef .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_dgde );}else {if _ggef =_edgg .Set (_ebb ._deg ,_dgde );_ggef !=nil {return _ggef ;};};_ebb ._eef ._gfe .Objects =append (_ebb ._eef ._gfe .Objects ,_dgde );
return nil ;};type Page struct{_bf int ;Object *_a .PdfObjectDictionary ;_gfe *Document ;};type Catalog struct{Object *_a .PdfObjectDictionary ;_e *Document ;};func (_ad *Catalog )SetMetadata (data []byte )error {_gga ,_fb :=_a .MakeStream (data ,nil );
if _fb !=nil {return _fb ;};_gga .Set ("\u0054\u0079\u0070\u0065",_a .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_gga .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_a .MakeName ("\u0058\u004d\u004c"));_ad .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_gga );
_ad ._e .Objects =append (_ad ._e .Objects ,_gga );return nil ;};type ImageSMask struct{Image *Image ;Stream *_a .PdfObjectStream ;};func (_gb *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_agc :_gb ._e }};func (_ebg *OutputIntents )Len ()int {return _ebg ._bec .Len ()};
func (_ece *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_ecd :=_ece .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");if _ecd ==nil {return nil ,false ;};_aa ,_ed :=_a .GetIndirect (_ecd );if !_ed {return nil ,false ;
};_bbd ,_af :=_a .GetArray (_aa .PdfObject );if !_af {return nil ,false ;};return &OutputIntents {_ga :_aa ,_bec :_bbd ,_agc :_ece ._e },true ;};type Content struct{Stream *_a .PdfObjectStream ;_deg int ;_eef Page ;};func (_fe *Catalog )GetPages ()([]Page ,bool ){_dg ,_df :=_a .GetDict (_fe .Object .Get ("\u0050\u0061\u0067e\u0073"));
if !_df {return nil ,false ;};_fg ,_gg :=_a .GetArray (_dg .Get ("\u004b\u0069\u0064\u0073"));if !_gg {return nil ,false ;};_ae :=make ([]Page ,_fg .Len ());for _ce ,_ag :=range _fg .Elements (){_ca ,_b :=_a .GetDict (_ag );if !_b {continue ;};_ae [_ce ]=Page {Object :_ca ,_bf :_ce +1,_gfe :_fe ._e };
};return _ae ,true ;};func (_ade Content )GetData ()([]byte ,error ){_aace ,_efe :=_a .NewEncoderFromStream (_ade .Stream );if _efe !=nil {return nil ,_efe ;};_afe ,_efe :=_aace .DecodeStream (_ade .Stream );if _efe !=nil {return nil ,_efe ;};return _afe ,nil ;
};func (_bb *Catalog )SetMarkInfo (mi _a .PdfObject ){if mi ==nil {_bb .Object .Remove ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f");return ;};_fa :=_a .MakeIndirectObject (mi );_bb .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_fa );
_bb ._e .Objects =append (_bb ._e .Objects ,_fa );};func _age (_fbd _a .PdfObject )(_a .PdfObjectName ,error ){var _afgb *_a .PdfObjectName ;var _gcb *_a .PdfObjectArray ;if _gf ,_ff :=_fbd .(*_a .PdfIndirectObject );_ff {if _egf ,_ecf :=_gf .PdfObject .(*_a .PdfObjectArray );
_ecf {_gcb =_egf ;}else if _eba ,_gdg :=_gf .PdfObject .(*_a .PdfObjectName );_gdg {_afgb =_eba ;};}else if _cgf ,_afd :=_fbd .(*_a .PdfObjectArray );_afd {_gcb =_cgf ;}else if _fafe ,_fea :=_fbd .(*_a .PdfObjectName );_fea {_afgb =_fafe ;};if _afgb !=nil {switch *_afgb {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_afgb ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_afgb ,nil ;};};if _gcb !=nil &&_gcb .Len ()> 0{if _aeg ,_cgg :=_gcb .Get (0).(*_a .PdfObjectName );_cgg {switch *_aeg {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _gcb .Len ()==1{return *_aeg ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_aeg ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_aeg ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_aeg ,nil ;};};};return "",nil ;};type OutputIntents struct{_bec *_a .PdfObjectArray ;_agc *Document ;_ga *_a .PdfIndirectObject ;};