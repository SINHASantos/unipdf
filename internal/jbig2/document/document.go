//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package document ;import (_g "encoding/binary";_e "fmt";_b "github.com/unidoc/unipdf/v3/common";_d "github.com/unidoc/unipdf/v3/internal/bitwise";_ea "github.com/unidoc/unipdf/v3/internal/jbig2/basic";_c "github.com/unidoc/unipdf/v3/internal/jbig2/bitmap";
_ag "github.com/unidoc/unipdf/v3/internal/jbig2/document/segments";_deb "github.com/unidoc/unipdf/v3/internal/jbig2/encoder/classer";_de "github.com/unidoc/unipdf/v3/internal/jbig2/errors";_ge "io";_a "math";_af "runtime/debug";);func (_fbba *Page )Encode (w _d .BinaryWriter )(_bac int ,_cda error ){const _fed ="P\u0061\u0067\u0065\u002e\u0045\u006e\u0063\u006f\u0064\u0065";
var _dgf int ;for _ ,_acg :=range _fbba .Segments {if _dgf ,_cda =_acg .Encode (w );_cda !=nil {return _bac ,_de .Wrap (_cda ,_fed ,"");};_bac +=_dgf ;};return _bac ,nil ;};func (_acfc *Page )AddPageInformationSegment (){_gbde :=&_ag .PageInformationSegment {PageBMWidth :_acfc .FinalWidth ,PageBMHeight :_acfc .FinalHeight ,ResolutionX :_acfc .ResolutionX ,ResolutionY :_acfc .ResolutionY ,IsLossless :_acfc .IsLossless };
if _acfc .BlackIsOne {_gbde .DefaultPixelValue =uint8 (0x1);};_fafe :=&_ag .Header {PageAssociation :_acfc .PageNumber ,SegmentDataLength :uint64 (_gbde .Size ()),SegmentData :_gbde ,Type :_ag .TPageInformation };_acfc .Segments =append (_acfc .Segments ,_fafe );
};var _dc =[]byte {0x97,0x4A,0x42,0x32,0x0D,0x0A,0x1A,0x0A};func DecodeDocument (input *_d .Reader ,globals *Globals )(*Document ,error ){return _eee (input ,globals );};func (_dfg *Page )getCombinationOperator (_fbda *_ag .PageInformationSegment ,_dcg _c .CombinationOperator )_c .CombinationOperator {if _fbda .CombinationOperatorOverrideAllowed (){return _dcg ;
};return _fbda .CombinationOperator ();};func (_ggf *Page )createPage (_daac *_ag .PageInformationSegment )error {var _aceb error ;if !_daac .IsStripe ||_daac .PageBMHeight !=-1{_aceb =_ggf .createNormalPage (_daac );}else {_aceb =_ggf .createStripedPage (_daac );
};return _aceb ;};func (_daad *Globals )GetSegment (segmentNumber int )(*_ag .Header ,error ){const _bde ="\u0047l\u006fb\u0061\u006c\u0073\u002e\u0047e\u0074\u0053e\u0067\u006d\u0065\u006e\u0074";if _daad ==nil {return nil ,_de .Error (_bde ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if len (_daad .Segments )==0{return nil ,_de .Error (_bde ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};var _adec *_ag .Header ;for _ ,_adec =range _daad .Segments {if _adec .SegmentNumber ==uint32 (segmentNumber ){break ;
};};if _adec ==nil {return nil ,_de .Error (_bde ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};return _adec ,nil ;};func (_acee *Document )GetGlobalSegment (i int )(*_ag .Header ,error ){_bfag ,_eadc :=_acee .GlobalSegments .GetSegment (i );
if _eadc !=nil {return nil ,_de .Wrap (_eadc ,"\u0047\u0065t\u0047\u006c\u006fb\u0061\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074","");};return _bfag ,nil ;};func (_bba *Globals )AddSegment (segment *_ag .Header ){_bba .Segments =append (_bba .Segments ,segment )};
func (_dbb *Page )getPageInformationSegment ()*_ag .Header {for _ ,_ddeb :=range _dbb .Segments {if _ddeb .Type ==_ag .TPageInformation {return _ddeb ;};};_b .Log .Debug ("\u0050\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066o\u0072\u0020\u0070\u0061\u0067\u0065\u003a\u0020%\u0073\u002e",_dbb );
return nil ;};type EncodingMethod int ;func (_adb *Document )nextSegmentNumber ()uint32 {_egg :=_adb .CurrentSegmentNumber ;_adb .CurrentSegmentNumber ++;return _egg ;};func (_dce *Page )createNormalPage (_cfeb *_ag .PageInformationSegment )error {const _gaad ="\u0063\u0072e\u0061\u0074\u0065N\u006f\u0072\u006d\u0061\u006c\u0050\u0061\u0067\u0065";
_dce .Bitmap =_c .New (_cfeb .PageBMWidth ,_cfeb .PageBMHeight );if _cfeb .DefaultPixelValue !=0{_dce .Bitmap .SetDefaultPixel ();};for _ ,_gfaa :=range _dce .Segments {switch _gfaa .Type {case 6,7,22,23,38,39,42,43:_b .Log .Trace ("\u0047\u0065\u0074\u0074in\u0067\u0020\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0064",_gfaa .SegmentNumber );
_dbd ,_cfed :=_gfaa .GetSegmentData ();if _cfed !=nil {return _cfed ;};_gdfb ,_cgd :=_dbd .(_ag .Regioner );if !_cgd {_b .Log .Debug ("\u0053\u0065g\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0054\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0052\u0065\u0067\u0069on\u0065\u0072",_dbd );
return _de .Errorf (_gaad ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062i\u0067\u0032\u0020\u0073\u0065\u0067\u006den\u0074\u0020\u0074\u0079p\u0065\u0020\u002d\u0020\u006e\u006f\u0074\u0020\u0061 R\u0065\u0067i\u006f\u006e\u0065\u0072\u003a\u0020\u0025\u0054",_dbd );
};_cgcf ,_cfed :=_gdfb .GetRegionBitmap ();if _cfed !=nil {return _de .Wrap (_cfed ,_gaad ,"");};if _dce .fitsPage (_cfeb ,_cgcf ){_dce .Bitmap =_cgcf ;}else {_aec :=_gdfb .GetRegionInfo ();_eca :=_dce .getCombinationOperator (_cfeb ,_aec .CombinaionOperator );
_cfed =_c .Blit (_cgcf ,_dce .Bitmap ,int (_aec .XLocation ),int (_aec .YLocation ),_eca );if _cfed !=nil {return _de .Wrap (_cfed ,_gaad ,"");};};};};return nil ;};func (_ga *Document )produceClassifiedPage (_eff *Page ,_gdb *_ag .Header )(_abd error ){const _bcc ="p\u0072\u006f\u0064\u0075ce\u0043l\u0061\u0073\u0073\u0069\u0066i\u0065\u0064\u0050\u0061\u0067\u0065";
var _baa map[int ]int ;_gda :=_ga ._ba ;_gbe :=[]*_ag .Header {_gdb };if len (_ga ._aaa [_eff .PageNumber ])> 0{_baa =map[int ]int {};_ff ,_gdf :=_ga .addSymbolDictionary (_eff .PageNumber ,_ga .Classer .UndilatedTemplates ,_ga ._aaa [_eff .PageNumber ],_baa ,false );
if _gdf !=nil {return _de .Wrap (_gdf ,_bcc ,"");};_gbe =append (_gbe ,_ff );_gda +=len (_ga ._aaa [_eff .PageNumber ]);};_df :=_ga ._gf [_eff .PageNumber ];_b .Log .Debug ("P\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020c\u006f\u006d\u0070\u0073: \u0025\u0076",_eff .PageNumber ,_df );
_eff .addTextRegionSegment (_gbe ,_ga ._fc ,_baa ,_ga ._gf [_eff .PageNumber ],_ga .Classer .PtaLL ,_ga .Classer .UndilatedTemplates ,_ga .Classer .ClassIDs ,nil ,_ccb (_gda ),len (_ga ._gf [_eff .PageNumber ]));return nil ;};func (_cfcc *Page )addTextRegionSegment (_adea []*_ag .Header ,_egc ,_gbac map[int ]int ,_ddcd []int ,_efb *_c .Points ,_ebdd *_c .Bitmaps ,_aea *_ea .IntSlice ,_baf *_c .Boxes ,_dcce ,_bea int ){_dfc :=&_ag .TextRegion {NumberOfSymbols :uint32 (_bea )};
_dfc .InitEncode (_egc ,_gbac ,_ddcd ,_efb ,_ebdd ,_aea ,_baf ,_cfcc .FinalWidth ,_cfcc .FinalHeight ,_dcce );_aab :=&_ag .Header {RTSegments :_adea ,SegmentData :_dfc ,PageAssociation :_cfcc .PageNumber ,Type :_ag .TImmediateTextRegion };_dddd :=_ag .TPageInformation ;
if _gbac !=nil {_dddd =_ag .TSymbolDictionary ;};var _ebe int ;for ;_ebe < len (_cfcc .Segments );_ebe ++{if _cfcc .Segments [_ebe ].Type ==_dddd {_ebe ++;break ;};};_cfcc .Segments =append (_cfcc .Segments ,nil );copy (_cfcc .Segments [_ebe +1:],_cfcc .Segments [_ebe :]);
_cfcc .Segments [_ebe ]=_aab ;};func (_def *Document )GetNumberOfPages ()(uint32 ,error ){if _def .NumberOfPagesUnknown ||_def .NumberOfPages ==0{if len (_def .Pages )==0{if _cgc :=_def .mapData ();_cgc !=nil {return 0,_de .Wrap (_cgc ,"\u0044o\u0063\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074N\u0075m\u0062e\u0072\u004f\u0066\u0050\u0061\u0067\u0065s","");
};};return uint32 (len (_def .Pages )),nil ;};return _def .NumberOfPages ,nil ;};func (_cfa *Document )mapData ()error {const _cdc ="\u006da\u0070\u0044\u0061\u0074\u0061";var (_fec []*_ag .Header ;_cfc int64 ;_ffab _ag .Type ;);_aba ,_gfed :=_cfa .isFileHeaderPresent ();
if _gfed !=nil {return _de .Wrap (_gfed ,_cdc ,"");};if _aba {if _gfed =_cfa .parseFileHeader ();_gfed !=nil {return _de .Wrap (_gfed ,_cdc ,"");};_cfc +=int64 (_cfa ._aa );_cfa .FullHeaders =true ;};var (_abbb *Page ;_cgb bool ;);for _ffab !=51&&!_cgb {_fbg ,_ebdf :=_ag .NewHeader (_cfa ,_cfa .InputStream ,_cfc ,_cfa .OrganizationType );
if _ebdf !=nil {return _de .Wrap (_ebdf ,_cdc ,"");};_b .Log .Trace ("\u0044\u0065c\u006f\u0064\u0069\u006eg\u0020\u0073e\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u0075m\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c\u0020\u0054\u0079\u0070e\u003a\u0020\u0025\u0073",_fbg .SegmentNumber ,_fbg .Type );
_ffab =_fbg .Type ;if _ffab !=_ag .TEndOfFile {if _fbg .PageAssociation !=0{_abbb =_cfa .Pages [_fbg .PageAssociation ];if _abbb ==nil {_abbb =_dab (_cfa ,_fbg .PageAssociation );_cfa .Pages [_fbg .PageAssociation ]=_abbb ;if _cfa .NumberOfPagesUnknown {_cfa .NumberOfPages ++;
};};_abbb .Segments =append (_abbb .Segments ,_fbg );}else {_cfa .GlobalSegments .AddSegment (_fbg );};};_fec =append (_fec ,_fbg );_cfc =_cfa .InputStream .AbsolutePosition ();if _cfa .OrganizationType ==_ag .OSequential {_cfc +=int64 (_fbg .SegmentDataLength );
};_cgb ,_ebdf =_cfa .reachedEOF (_cfc );if _ebdf !=nil {_b .Log .Debug ("\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u0072\u0065\u0061\u0063h\u0065\u0064\u0020\u0045\u004f\u0046\u0020\u0077\u0069\u0074\u0068\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0076",_ebdf );
return _de .Wrap (_ebdf ,_cdc ,"");};};_cfa .determineRandomDataOffsets (_fec ,uint64 (_cfc ));return nil ;};func (_gab *Document )reachedEOF (_gba int64 )(bool ,error ){const _cgg ="\u0072\u0065\u0061\u0063\u0068\u0065\u0064\u0045\u004f\u0046";_ ,_bbce :=_gab .InputStream .Seek (_gba ,_ge .SeekStart );
if _bbce !=nil {_b .Log .Debug ("\u0072\u0065\u0061c\u0068\u0065\u0064\u0045\u004f\u0046\u0020\u002d\u0020\u0064\u002e\u0049\u006e\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u002e\u0053\u0065\u0065\u006b\u0020\u0066a\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_bbce );
return false ,_de .Wrap (_bbce ,_cgg ,"\u0069n\u0070\u0075\u0074\u0020\u0073\u0074\u0072\u0065\u0061\u006d\u0020s\u0065\u0065\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};_ ,_bbce =_gab .InputStream .ReadBits (32);if _bbce ==_ge .EOF {return true ,nil ;
}else if _bbce !=nil {return false ,_de .Wrap (_bbce ,_cgg ,"");};return false ,nil ;};func (_cfg *Page )String ()string {return _e .Sprintf ("\u0050\u0061\u0067\u0065\u0020\u0023\u0025\u0064",_cfg .PageNumber );};func (_efgf *Document )isFileHeaderPresent ()(bool ,error ){_efgf .InputStream .Mark ();
for _ ,_bfg :=range _dc {_ebf ,_cf :=_efgf .InputStream .ReadByte ();if _cf !=nil {return false ,_cf ;};if _bfg !=_ebf {_efgf .InputStream .Reset ();return false ,nil ;};};_efgf .InputStream .Reset ();return true ,nil ;};func _ccb (_ebd int )int {_bd :=0;
_cd :=(_ebd &(_ebd -1))==0;_ebd >>=1;for ;_ebd !=0;_ebd >>=1{_bd ++;};if _cd {return _bd ;};return _bd +1;};func (_ddd *Page )AddEndOfPageSegment (){_dgb :=&_ag .Header {Type :_ag .TEndOfPage ,PageAssociation :_ddd .PageNumber };_ddd .Segments =append (_ddd .Segments ,_dgb );
};func (_gdd *Page )composePageBitmap ()error {const _fbbe ="\u0063\u006f\u006d\u0070\u006f\u0073\u0065\u0050\u0061\u0067\u0065\u0042i\u0074\u006d\u0061\u0070";if _gdd .PageNumber ==0{return nil ;};_cfe :=_gdd .getPageInformationSegment ();if _cfe ==nil {return _de .Error (_fbbe ,"\u0070\u0061\u0067e \u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069o\u006e \u0073e\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};_ddcb ,_beed :=_cfe .GetSegmentData ();if _beed !=nil {return _beed ;};_fcb ,_fdga :=_ddcb .(*_ag .PageInformationSegment );if !_fdga {return _de .Error (_fbbe ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006da\u0074\u0069\u006f\u006e \u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070\u0065");
};if _beed =_gdd .createPage (_fcb );_beed !=nil {return _de .Wrap (_beed ,_fbbe ,"");};_gdd .clearSegmentData ();return nil ;};func (_cae *Document )completeSymbols ()(_bdf error ){const _ebb ="\u0063o\u006dp\u006c\u0065\u0074\u0065\u0053\u0079\u006d\u0062\u006f\u006c\u0073";
if _cae .Classer ==nil {return nil ;};if _cae .Classer .UndilatedTemplates ==nil {return _de .Error (_ebb ,"\u006e\u006f t\u0065\u006d\u0070l\u0061\u0074\u0065\u0073 de\u0066in\u0065\u0064\u0020\u0066\u006f\u0072\u0020th\u0065\u0020\u0063\u006c\u0061\u0073\u0073e\u0072");
};_dg :=len (_cae .Pages )==1;_fbac :=make ([]int ,_cae .Classer .UndilatedTemplates .Size ());var _gfg int ;for _agf :=0;_agf < _cae .Classer .ClassIDs .Size ();_agf ++{_gfg ,_bdf =_cae .Classer .ClassIDs .Get (_agf );if _bdf !=nil {return _de .Wrap (_bdf ,_ebb ,"\u0063\u006c\u0061\u0073\u0073\u0020\u0049\u0044\u0027\u0073");
};_fbac [_gfg ]++;};var _ege []int ;for _ace :=0;_ace < _cae .Classer .UndilatedTemplates .Size ();_ace ++{if _fbac [_ace ]==0{return _de .Error (_ebb ,"\u006eo\u0020\u0073y\u006d\u0062\u006f\u006cs\u0020\u0069\u006es\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u0066\u006fun\u0064\u0020\u0066o\u0072\u0020g\u0069\u0076\u0065\u006e\u0020\u0063l\u0061\u0073s\u003f\u0020");
};if _fbac [_ace ]> 1||_dg {_ege =append (_ege ,_ace );};};_cae ._ba =len (_ege );var _be ,_bbc int ;for _da :=0;_da < _cae .Classer .ComponentPageNumbers .Size ();_da ++{_be ,_bdf =_cae .Classer .ComponentPageNumbers .Get (_da );if _bdf !=nil {return _de .Wrapf (_bdf ,_ebb ,"p\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027 \u006e\u006f\u0074\u0020\u0066\u006f\u0075nd\u0020\u0069\u006e\u0020t\u0068\u0065\u0020\u0063\u006c\u0061\u0073\u0073\u0065r \u0070\u0061g\u0065\u006e\u0075\u006d\u0062\u0065\u0072\u0073",_da );
};_bbc ,_bdf =_cae .Classer .ClassIDs .Get (_da );if _bdf !=nil {return _de .Wrapf (_bdf ,_ebb ,"\u0063\u0061\u006e\u0027\u0074\u0020\u0067e\u0074\u0020\u0073y\u006d\u0062\u006f\u006c \u0066\u006f\u0072\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072",_be );
};if _fbac [_bbc ]==1&&!_dg {_cae ._aaa [_be ]=append (_cae ._aaa [_be ],_bbc );};};if _bdf =_cae .Classer .ComputeLLCorners ();_bdf !=nil {return _de .Wrap (_bdf ,_ebb ,"");};return nil ;};func (_ce *Document )produceClassifiedPages ()(_abbc error ){const _ecc ="\u0070\u0072\u006f\u0064uc\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067e\u0073";
if _ce .Classer ==nil {return nil ;};var (_gce *Page ;_ccf bool ;_gec *_ag .Header ;);for _gg :=1;_gg <=int (_ce .NumberOfPages );_gg ++{if _gce ,_ccf =_ce .Pages [_gg ];!_ccf {return _de .Errorf (_ecc ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_gg );
};if _gce .EncodingMethod ==GenericEM {continue ;};if _gec ==nil {if _gec ,_abbc =_ce .GlobalSegments .GetSymbolDictionary ();_abbc !=nil {return _de .Wrap (_abbc ,_ecc ,"");};};if _abbc =_ce .produceClassifiedPage (_gce ,_gec );_abbc !=nil {return _de .Wrapf (_abbc ,_ecc ,"\u0070\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027",_gg );
};};return nil ;};func (_fb *Document )AddGenericPage (bm *_c .Bitmap ,duplicateLineRemoval bool )(_ee error ){const _bc ="\u0044\u006f\u0063um\u0065\u006e\u0074\u002e\u0041\u0064\u0064\u0047\u0065\u006e\u0065\u0072\u0069\u0063\u0050\u0061\u0067\u0065";
if !_fb .FullHeaders &&_fb .NumberOfPages !=0{return _de .Error (_bc ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};_cb :=&Page {Segments :[]*_ag .Header {},Bitmap :bm ,Document :_fb ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,IsLossless :true ,BlackIsOne :bm .Color ==_c .Chocolate };_cb .PageNumber =int (_fb .nextPageNumber ());_fb .Pages [_cb .PageNumber ]=_cb ;
bm .InverseData ();_cb .AddPageInformationSegment ();if _ee =_cb .AddGenericRegion (bm ,0,0,0,_ag .TImmediateGenericRegion ,duplicateLineRemoval );_ee !=nil {return _de .Wrap (_ee ,_bc ,"");};if _fb .FullHeaders {_cb .AddEndOfPageSegment ();};return nil ;
};func (_gaa *Document )nextPageNumber ()uint32 {_gaa .NumberOfPages ++;return _gaa .NumberOfPages };func (_dfe *Page )createStripedPage (_dfef *_ag .PageInformationSegment )error {const _fda ="\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0074\u0072\u0069\u0070\u0065d\u0050\u0061\u0067\u0065";
_ed ,_dced :=_dfe .collectPageStripes ();if _dced !=nil {return _de .Wrap (_dced ,_fda ,"");};var _bgc int ;for _ ,_ddb :=range _ed {if _ded ,_geg :=_ddb .(*_ag .EndOfStripe );_geg {_bgc =_ded .LineNumber ()+1;}else {_fag :=_ddb .(_ag .Regioner );_cdfc :=_fag .GetRegionInfo ();
_dag :=_dfe .getCombinationOperator (_dfef ,_cdfc .CombinaionOperator );_cbf ,_dede :=_fag .GetRegionBitmap ();if _dede !=nil {return _de .Wrap (_dede ,_fda ,"");};_dede =_c .Blit (_cbf ,_dfe .Bitmap ,int (_cdfc .XLocation ),_bgc ,_dag );if _dede !=nil {return _de .Wrap (_dede ,_fda ,"");
};};};return nil ;};func _eee (_cdf *_d .Reader ,_deff *Globals )(*Document ,error ){_fcc :=&Document {Pages :make (map[int ]*Page ),InputStream :_cdf ,OrganizationType :_ag .OSequential ,NumberOfPagesUnknown :true ,GlobalSegments :_deff ,_aa :9};if _fcc .GlobalSegments ==nil {_fcc .GlobalSegments =&Globals {};
};if _deg :=_fcc .mapData ();_deg !=nil {return nil ,_deg ;};return _fcc ,nil ;};func (_cea *Document )parseFileHeader ()error {const _ddc ="\u0070a\u0072s\u0065\u0046\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_ ,_ebgd :=_cea .InputStream .Seek (8,_ge .SeekStart );
if _ebgd !=nil {return _de .Wrap (_ebgd ,_ddc ,"\u0069\u0064");};_ ,_ebgd =_cea .InputStream .ReadBits (5);if _ebgd !=nil {return _de .Wrap (_ebgd ,_ddc ,"\u0072\u0065\u0073\u0065\u0072\u0076\u0065\u0064\u0020\u0062\u0069\u0074\u0073");};_eea ,_ebgd :=_cea .InputStream .ReadBit ();
if _ebgd !=nil {return _de .Wrap (_ebgd ,_ddc ,"\u0065x\u0074e\u006e\u0064\u0065\u0064\u0020t\u0065\u006dp\u006c\u0061\u0074\u0065\u0073");};if _eea ==1{_cea .GBUseExtTemplate =true ;};_eea ,_ebgd =_cea .InputStream .ReadBit ();if _ebgd !=nil {return _de .Wrap (_ebgd ,_ddc ,"\u0075\u006e\u006b\u006eow\u006e\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");
};if _eea !=1{_cea .NumberOfPagesUnknown =false ;};_eea ,_ebgd =_cea .InputStream .ReadBit ();if _ebgd !=nil {return _de .Wrap (_ebgd ,_ddc ,"\u006f\u0072\u0067\u0061\u006e\u0069\u007a\u0061\u0074\u0069\u006f\u006e \u0074\u0079\u0070\u0065");};_cea .OrganizationType =_ag .OrganizationType (_eea );
if !_cea .NumberOfPagesUnknown {_cea .NumberOfPages ,_ebgd =_cea .InputStream .ReadUint32 ();if _ebgd !=nil {return _de .Wrap (_ebgd ,_ddc ,"\u006eu\u006db\u0065\u0072\u0020\u006f\u0066\u0020\u0070\u0061\u0067\u0065\u0073");};_cea ._aa =13;};return nil ;
};func (_bdb *Document )addSymbolDictionary (_fae int ,_cg *_c .Bitmaps ,_gfc []int ,_ead map[int ]int ,_cac bool )(*_ag .Header ,error ){const _ac ="\u0061\u0064\u0064\u0053ym\u0062\u006f\u006c\u0044\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079";
_bf :=&_ag .SymbolDictionary {};if _bg :=_bf .InitEncode (_cg ,_gfc ,_ead ,_cac );_bg !=nil {return nil ,_bg ;};_bb :=&_ag .Header {Type :_ag .TSymbolDictionary ,PageAssociation :_fae ,SegmentData :_bf };if _fae ==0{if _bdb .GlobalSegments ==nil {_bdb .GlobalSegments =&Globals {};
};_bdb .GlobalSegments .AddSegment (_bb );return _bb ,nil ;};_fcd ,_dd :=_bdb .Pages [_fae ];if !_dd {return nil ,_de .Errorf (_ac ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_fae );};var (_bag int ;
_ebg *_ag .Header ;);for _bag ,_ebg =range _fcd .Segments {if _ebg .Type ==_ag .TPageInformation {break ;};};_bag ++;_fcd .Segments =append (_fcd .Segments ,nil );copy (_fcd .Segments [_bag +1:],_fcd .Segments [_bag :]);_fcd .Segments [_bag ]=_bb ;return _bb ,nil ;
};func (_ae *Document )Encode ()(_dfd []byte ,_gge error ){const _abda ="\u0044o\u0063u\u006d\u0065\u006e\u0074\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _fg ,_ece int ;if _ae .FullHeaders {if _fg ,_gge =_ae .encodeFileHeader (_ae ._ca );_gge !=nil {return nil ,_de .Wrap (_gge ,_abda ,"");
};};var (_daa bool ;_acf *_ag .Header ;_gfe *Page ;);if _gge =_ae .completeClassifiedPages ();_gge !=nil {return nil ,_de .Wrap (_gge ,_abda ,"");};if _gge =_ae .produceClassifiedPages ();_gge !=nil {return nil ,_de .Wrap (_gge ,_abda ,"");};if _ae .GlobalSegments !=nil {for _ ,_acf =range _ae .GlobalSegments .Segments {if _gge =_ae .encodeSegment (_acf ,&_fg );
_gge !=nil {return nil ,_de .Wrap (_gge ,_abda ,"");};};};for _ad :=1;_ad <=int (_ae .NumberOfPages );_ad ++{if _gfe ,_daa =_ae .Pages [_ad ];!_daa {return nil ,_de .Errorf (_abda ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_ad );
};for _ ,_acf =range _gfe .Segments {if _gge =_ae .encodeSegment (_acf ,&_fg );_gge !=nil {return nil ,_de .Wrap (_gge ,_abda ,"");};};};if _ae .FullHeaders {if _ece ,_gge =_ae .encodeEOFHeader (_ae ._ca );_gge !=nil {return nil ,_de .Wrap (_gge ,_abda ,"");
};_fg +=_ece ;};_dfd =_ae ._ca .Data ();if len (_dfd )!=_fg {_b .Log .Debug ("\u0042\u0079\u0074\u0065\u0073 \u0077\u0072\u0069\u0074\u0074\u0065\u006e \u0028\u006e\u0029\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0074\u0068\u0065\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u0020\u006f\u0066\u0020t\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0065\u006e\u0063\u006fd\u0065\u0064\u003a\u0020\u0027\u0025d\u0027",_fg ,len (_dfd ));
};return _dfd ,nil ;};type Globals struct{Segments []*_ag .Header ;};func InitEncodeDocument (fullHeaders bool )*Document {return &Document {FullHeaders :fullHeaders ,_ca :_d .BufferedMSB (),Pages :map[int ]*Page {},_aaa :map[int ][]int {},_fc :map[int ]int {},_gf :map[int ][]int {}};
};func (_fbaf *Page )lastSegmentNumber ()(_bafd uint32 ,_edc error ){const _gga ="\u006c\u0061\u0073\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u004eu\u006d\u0062\u0065\u0072";if len (_fbaf .Segments )==0{return _bafd ,_de .Errorf (_gga ,"\u006e\u006f\u0020se\u0067\u006d\u0065\u006e\u0074\u0073\u0020\u0066\u006fu\u006ed\u0020i\u006e \u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027",_fbaf .PageNumber );
};return _fbaf .Segments [len (_fbaf .Segments )-1].SegmentNumber ,nil ;};func (_efe *Page )AddGenericRegion (bm *_c .Bitmap ,xloc ,yloc ,template int ,tp _ag .Type ,duplicateLineRemoval bool )error {const _cdce ="P\u0061\u0067\u0065\u002eAd\u0064G\u0065\u006e\u0065\u0072\u0069c\u0052\u0065\u0067\u0069\u006f\u006e";
_cfca :=&_ag .GenericRegion {};if _dbc :=_cfca .InitEncode (bm ,xloc ,yloc ,template ,duplicateLineRemoval );_dbc !=nil {return _de .Wrap (_dbc ,_cdce ,"");};_bbg :=&_ag .Header {Type :_ag .TImmediateGenericRegion ,PageAssociation :_efe .PageNumber ,SegmentData :_cfca };
_efe .Segments =append (_efe .Segments ,_bbg );return nil ;};func (_geaa *Page )collectPageStripes ()(_ffb []_ag .Segmenter ,_dcb error ){const _dceb ="\u0063o\u006cl\u0065\u0063\u0074\u0050\u0061g\u0065\u0053t\u0072\u0069\u0070\u0065\u0073";var _efc _ag .Segmenter ;
for _ ,_adcg :=range _geaa .Segments {switch _adcg .Type {case 6,7,22,23,38,39,42,43:_efc ,_dcb =_adcg .GetSegmentData ();if _dcb !=nil {return nil ,_de .Wrap (_dcb ,_dceb ,"");};_ffb =append (_ffb ,_efc );case 50:_efc ,_dcb =_adcg .GetSegmentData ();if _dcb !=nil {return nil ,_dcb ;
};_fbab ,_gcf :=_efc .(*_ag .EndOfStripe );if !_gcf {return nil ,_de .Errorf (_dceb ,"\u0045\u006e\u0064\u004f\u0066\u0053\u0074\u0072\u0069\u0070\u0065\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u006f\u0066\u0020\u0076\u0061l\u0069\u0064\u0020\u0074\u0079p\u0065\u003a \u0027\u0025\u0054\u0027",_efc );
};_ffb =append (_ffb ,_fbab );_geaa .FinalHeight =_fbab .LineNumber ();};};return _ffb ,nil ;};func (_bgg *Page )GetWidth ()(int ,error ){return _bgg .getWidth ()};func (_ddf *Document )encodeEOFHeader (_cec _d .BinaryWriter )(_cad int ,_ade error ){_ffe :=&_ag .Header {SegmentNumber :_ddf .nextSegmentNumber (),Type :_ag .TEndOfFile };
if _cad ,_ade =_ffe .Encode (_cec );_ade !=nil {return 0,_de .Wrap (_ade ,"\u0065n\u0063o\u0064\u0065\u0045\u004f\u0046\u0048\u0065\u0061\u0064\u0065\u0072","");};return _cad ,nil ;};func (_bda *Page )getResolutionY ()(int ,error ){const _eeb ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0059";
if _bda .ResolutionY !=0{return _bda .ResolutionY ,nil ;};_eaec :=_bda .getPageInformationSegment ();if _eaec ==nil {return 0,_de .Error (_eeb ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_geba ,_bddd :=_eaec .GetSegmentData ();
if _bddd !=nil {return 0,_de .Wrap (_bddd ,_eeb ,"");};_dfeg ,_caf :=_geba .(*_ag .PageInformationSegment );if !_caf {return 0,_de .Errorf (_eeb ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0074\u0079\u0070\u0065\u003a\u0027%\u0054\u0027",_geba );
};_bda .ResolutionY =_dfeg .ResolutionY ;return _bda .ResolutionY ,nil ;};func (_adce *Globals )GetSegmentByIndex (index int )(*_ag .Header ,error ){const _ecg ="\u0047l\u006f\u0062\u0061\u006cs\u002e\u0047\u0065\u0074\u0053e\u0067m\u0065n\u0074\u0042\u0079\u0049\u006e\u0064\u0065x";
if _adce ==nil {return nil ,_de .Error (_ecg ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_adce .Segments )==0{return nil ,_de .Error (_ecg ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};if index > len (_adce .Segments )-1{return nil ,_de .Error (_ecg ,"\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");};return _adce .Segments [index ],nil ;};func (_cace *Page )GetHeight ()(int ,error ){return _cace .getHeight ()};
func (_aeg *Page )GetResolutionX ()(int ,error ){return _aeg .getResolutionX ()};func (_fea *Page )fitsPage (_efbe *_ag .PageInformationSegment ,_aag *_c .Bitmap )bool {return _fea .countRegions ()==1&&_efbe .DefaultPixelValue ==0&&_efbe .PageBMWidth ==_aag .Width &&_efbe .PageBMHeight ==_aag .Height ;
};func _dab (_gbf *Document ,_dee int )*Page {return &Page {Document :_gbf ,PageNumber :_dee ,Segments :[]*_ag .Header {}};};func (_fbe *Page )getHeight ()(int ,error ){const _edgg ="\u0067e\u0074\u0048\u0065\u0069\u0067\u0068t";if _fbe .FinalHeight !=0{return _fbe .FinalHeight ,nil ;
};_fbgc :=_fbe .getPageInformationSegment ();if _fbgc ==nil {return 0,_de .Error (_edgg ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_ggeg ,_ggff :=_fbgc .GetSegmentData ();if _ggff !=nil {return 0,_de .Wrap (_ggff ,_edgg ,"");
};_acfd ,_ffea :=_ggeg .(*_ag .PageInformationSegment );if !_ffea {return 0,_de .Errorf (_edgg ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_ggeg );
};if _acfd .PageBMHeight ==_a .MaxInt32 {_ ,_ggff =_fbe .GetBitmap ();if _ggff !=nil {return 0,_de .Wrap (_ggff ,_edgg ,"");};}else {_fbe .FinalHeight =_acfd .PageBMHeight ;};return _fbe .FinalHeight ,nil ;};func (_bdfc *Document )determineRandomDataOffsets (_dde []*_ag .Header ,_eccd uint64 ){if _bdfc .OrganizationType !=_ag .ORandom {return ;
};for _ ,_adc :=range _dde {_adc .SegmentDataStartOffset =_eccd ;_eccd +=_adc .SegmentDataLength ;};};func (_dae *Document )encodeFileHeader (_fbb _d .BinaryWriter )(_fbc int ,_efg error ){const _ccg ="\u0065\u006ec\u006f\u0064\u0065F\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";
_fbc ,_efg =_fbb .Write (_dc );if _efg !=nil {return _fbc ,_de .Wrap (_efg ,_ccg ,"\u0069\u0064");};if _efg =_fbb .WriteByte (0x01);_efg !=nil {return _fbc ,_de .Wrap (_efg ,_ccg ,"\u0066\u006c\u0061g\u0073");};_fbc ++;_fbff :=make ([]byte ,4);_g .BigEndian .PutUint32 (_fbff ,_dae .NumberOfPages );
_bca ,_efg :=_fbb .Write (_fbff );if _efg !=nil {return _bca ,_de .Wrap (_efg ,_ccg ,"p\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};_fbc +=_bca ;return _fbc ,nil ;};const (GenericEM EncodingMethod =iota ;CorrelationEM ;RankHausEM ;);
func (_faee *Page )countRegions ()int {var _gcd int ;for _ ,_fedb :=range _faee .Segments {switch _fedb .Type {case 6,7,22,23,38,39,42,43:_gcd ++;};};return _gcd ;};func (_bae *Page )GetResolutionY ()(int ,error ){return _bae .getResolutionY ()};func (_dcf *Document )encodeSegment (_gfa *_ag .Header ,_bfa *int )error {const _fe ="\u0065\u006e\u0063\u006f\u0064\u0065\u0053\u0065\u0067\u006d\u0065\u006e\u0074";
_gfa .SegmentNumber =_dcf .nextSegmentNumber ();_gea ,_baag :=_gfa .Encode (_dcf ._ca );if _baag !=nil {return _de .Wrapf (_baag ,_fe ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0027\u0025\u0064\u0027",_gfa .SegmentNumber );};*_bfa +=_gea ;
return nil ;};func (_fba *Document )AddClassifiedPage (bm *_c .Bitmap ,method _deb .Method )(_bcg error ){const _afb ="\u0044\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u002e\u0041\u0064d\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064P\u0061\u0067\u0065";
if !_fba .FullHeaders &&_fba .NumberOfPages !=0{return _de .Error (_afb ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};if _fba .Classer ==nil {if _fba .Classer ,_bcg =_deb .Init (_deb .DefaultSettings ());_bcg !=nil {return _de .Wrap (_bcg ,_afb ,"");};};_ab :=int (_fba .nextPageNumber ());_abb :=&Page {Segments :[]*_ag .Header {},Bitmap :bm ,Document :_fba ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,PageNumber :_ab };
_fba .Pages [_ab ]=_abb ;switch method {case _deb .RankHaus :_abb .EncodingMethod =RankHausEM ;case _deb .Correlation :_abb .EncodingMethod =CorrelationEM ;};_abb .AddPageInformationSegment ();if _bcg =_fba .Classer .AddPage (bm ,_ab ,method );_bcg !=nil {return _de .Wrap (_bcg ,_afb ,"");
};if _fba .FullHeaders {_abb .AddEndOfPageSegment ();};return nil ;};func (_fagb *Page )nextSegmentNumber ()uint32 {return _fagb .Document .nextSegmentNumber ()};func (_bfae *Page )clearSegmentData (){for _edg :=range _bfae .Segments {_bfae .Segments [_edg ].CleanSegmentData ();
};};func (_dac *Page )getResolutionX ()(int ,error ){const _eae ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0058";if _dac .ResolutionX !=0{return _dac .ResolutionX ,nil ;};_agg :=_dac .getPageInformationSegment ();if _agg ==nil {return 0,_de .Error (_eae ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_fcf ,_beeb :=_agg .GetSegmentData ();if _beeb !=nil {return 0,_de .Wrap (_beeb ,_eae ,"");};_fcg ,_feaf :=_fcf .(*_ag .PageInformationSegment );if !_feaf {return 0,_de .Errorf (_eae ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_fcf );
};_dac .ResolutionX =_fcg .ResolutionX ;return _dac .ResolutionX ,nil ;};func (_daec *Page )getWidth ()(int ,error ){const _ebfa ="\u0067\u0065\u0074\u0057\u0069\u0064\u0074\u0068";if _daec .FinalWidth !=0{return _daec .FinalWidth ,nil ;};_eec :=_daec .getPageInformationSegment ();
if _eec ==nil {return 0,_de .Error (_ebfa ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_aed ,_edd :=_eec .GetSegmentData ();if _edd !=nil {return 0,_de .Wrap (_edd ,_ebfa ,"");};_cbfe ,_cca :=_aed .(*_ag .PageInformationSegment );
if !_cca {return 0,_de .Errorf (_ebfa ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_aed );
};_daec .FinalWidth =_cbfe .PageBMWidth ;return _daec .FinalWidth ,nil ;};func (_fbfa *Globals )GetSymbolDictionary ()(*_ag .Header ,error ){const _agb ="G\u006c\u006f\u0062\u0061\u006c\u0073.\u0047\u0065\u0074\u0053\u0079\u006d\u0062\u006f\u006cD\u0069\u0063\u0074i\u006fn\u0061\u0072\u0079";
if _fbfa ==nil {return nil ,_de .Error (_agb ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_fbfa .Segments )==0{return nil ,_de .Error (_agb ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};for _ ,_ebdg :=range _fbfa .Segments {if _ebdg .Type ==_ag .TSymbolDictionary {return _ebdg ,nil ;};};return nil ,_de .Error (_agb ,"\u0067\u006c\u006fba\u006c\u0020\u0073\u0079\u006d\u0062\u006f\u006c\u0020d\u0069c\u0074i\u006fn\u0061\u0072\u0079\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};type Document struct{Pages map[int ]*Page ;NumberOfPagesUnknown bool ;NumberOfPages uint32 ;GBUseExtTemplate bool ;InputStream *_d .Reader ;GlobalSegments *Globals ;OrganizationType _ag .OrganizationType ;Classer *_deb .Classer ;XRes ,YRes int ;FullHeaders bool ;
CurrentSegmentNumber uint32 ;AverageTemplates *_c .Bitmaps ;BaseIndexes []int ;Refinement bool ;RefineLevel int ;_aa uint8 ;_ca *_d .BufferedWriter ;EncodeGlobals bool ;_ba int ;_aaa map[int ][]int ;_gf map[int ][]int ;_gb []int ;_fc map[int ]int ;};func (_gc *Document )completeClassifiedPages ()(_dcc error ){const _eb ="\u0063\u006f\u006dpl\u0065\u0074\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067\u0065\u0073";
if _gc .Classer ==nil {return nil ;};_gc ._gb =make ([]int ,_gc .Classer .UndilatedTemplates .Size ());for _ef :=0;_ef < _gc .Classer .ClassIDs .Size ();_ef ++{_dcca ,_afa :=_gc .Classer .ClassIDs .Get (_ef );if _afa !=nil {return _de .Wrapf (_afa ,_eb ,"\u0063\u006c\u0061\u0073s \u0077\u0069\u0074\u0068\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027",_ef );
};_gc ._gb [_dcca ]++;};var _gef []int ;for _fbf :=0;_fbf < _gc .Classer .UndilatedTemplates .Size ();_fbf ++{if _gc .NumberOfPages ==1||_gc ._gb [_fbf ]> 1{_gef =append (_gef ,_fbf );};};var (_ec *Page ;_cc bool ;);for _gd ,_fa :=range *_gc .Classer .ComponentPageNumbers {if _ec ,_cc =_gc .Pages [_fa ];
!_cc {return _de .Errorf (_eb ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_gd );};if _ec .EncodingMethod ==GenericEM {_b .Log .Error ("\u0047\u0065\u006e\u0065\u0072\u0069c\u0020\u0070\u0061g\u0065\u0020\u0077i\u0074\u0068\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020ma\u0070\u0070\u0065\u0064\u0020\u0061\u0073\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0020\u0070\u0061\u0067\u0065",_gd );
continue ;};_gc ._gf [_fa ]=append (_gc ._gf [_fa ],_gd );_db ,_fca :=_gc .Classer .ClassIDs .Get (_gd );if _fca !=nil {return _de .Wrapf (_fca ,_eb ,"\u006e\u006f\u0020\u0073uc\u0068\u0020\u0063\u006c\u0061\u0073\u0073\u0049\u0044\u003a\u0020\u0025\u0064",_gd );
};if _gc ._gb [_db ]==1&&_gc .NumberOfPages !=1{_aga :=append (_gc ._aaa [_fa ],_db );_gc ._aaa [_fa ]=_aga ;};};if _dcc =_gc .Classer .ComputeLLCorners ();_dcc !=nil {return _de .Wrap (_dcc ,_eb ,"");};if _ ,_dcc =_gc .addSymbolDictionary (0,_gc .Classer .UndilatedTemplates ,_gef ,_gc ._fc ,false );
_dcc !=nil {return _de .Wrap (_dcc ,_eb ,"");};return nil ;};func (_caa *Page )GetSegment (number int )(*_ag .Header ,error ){const _fde ="\u0050a\u0067e\u002e\u0047\u0065\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074";for _ ,_adbd :=range _caa .Segments {if _adbd .SegmentNumber ==uint32 (number ){return _adbd ,nil ;
};};_fbd :=make ([]uint32 ,len (_caa .Segments ));for _bdd ,_cgbb :=range _caa .Segments {_fbd [_bdd ]=_cgbb .SegmentNumber ;};return nil ,_de .Errorf (_fde ,"\u0073e\u0067\u006d\u0065n\u0074\u0020\u0077i\u0074h \u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u003a\u0020'%\u0064'\u002e\u0020\u004b\u006e\u006f\u0077n\u0020\u0073\u0065\u0067\u006de\u006e\u0074\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0073\u003a \u0025\u0076",number ,_caa .PageNumber ,_fbd );
};func (_bbcc *Page )GetBitmap ()(_fd *_c .Bitmap ,_fdg error ){_b .Log .Trace (_e .Sprintf ("\u005b\u0050\u0041G\u0045\u005d\u005b\u0023%\u0064\u005d\u0020\u0047\u0065\u0074\u0042i\u0074\u006d\u0061\u0070\u0020\u0062\u0065\u0067\u0069\u006e\u0073\u002e\u002e\u002e",_bbcc .PageNumber ));
defer func (){if _fdg !=nil {_b .Log .Trace (_e .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064\u005d\u0020\u0047\u0065\u0074B\u0069t\u006d\u0061\u0070\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e\u0020\u0025\u0076",_bbcc .PageNumber ,_fdg ));
}else {_b .Log .Trace (_e .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064]\u0020\u0047\u0065\u0074\u0042\u0069\u0074m\u0061\u0070\u0020\u0066\u0069\u006e\u0069\u0073\u0068\u0065\u0064",_bbcc .PageNumber ));};}();if _bbcc .Bitmap !=nil {return _bbcc .Bitmap ,nil ;
};_fdg =_bbcc .composePageBitmap ();if _fdg !=nil {return nil ,_fdg ;};return _bbcc .Bitmap ,nil ;};type Page struct{Segments []*_ag .Header ;PageNumber int ;Bitmap *_c .Bitmap ;FinalHeight int ;FinalWidth int ;ResolutionX int ;ResolutionY int ;IsLossless bool ;
Document *Document ;FirstSegmentNumber int ;EncodingMethod EncodingMethod ;BlackIsOne bool ;};func (_bdc *Document )GetPage (pageNumber int )(_ag .Pager ,error ){const _ffa ="\u0044\u006fc\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074\u0050\u0061\u0067\u0065";
if pageNumber < 0{_b .Log .Debug ("\u004a\u0042\u0049\u00472\u0020\u0050\u0061\u0067\u0065\u0020\u002d\u0020\u0047e\u0074\u0050\u0061\u0067\u0065\u003a\u0020\u0025\u0064\u002e\u0020\u0050\u0061\u0067\u0065\u0020\u0063\u0061n\u006e\u006f\u0074\u0020\u0062e\u0020\u006c\u006f\u0077\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u0030\u002e\u0020\u0025\u0073",pageNumber ,_af .Stack ());
return nil ,_de .Errorf (_ffa ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032\u0020d\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u002d\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064 \u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064",pageNumber );
};if pageNumber > len (_bdc .Pages ){_b .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_af .Stack ());return nil ,_de .Error (_ffa ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};_dcfc ,_cee :=_bdc .Pages [pageNumber ];if !_cee {_b .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_af .Stack ());return nil ,_de .Errorf (_ffa ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};return _dcfc ,nil ;};