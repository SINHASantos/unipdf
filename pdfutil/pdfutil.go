//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package pdfutil ;import (_cg "errors";_db "github.com/unidoc/unipdf/v4/common";_g "github.com/unidoc/unipdf/v4/contentstream";_d "github.com/unidoc/unipdf/v4/contentstream/draw";_b "github.com/unidoc/unipdf/v4/core";_a "github.com/unidoc/unipdf/v4/model";
_ce "github.com/unidoc/unipdf/v4/ps";);func _adc (_abd *_a .PdfPattern )(*_a .PdfPattern ,error ){if _abd .IsTiling (){_bbce :=_abd .GetAsTilingPattern ();if _bbce .IsColored (){_ece ,_gcca :=_bbce .GetContentStream ();if _gcca !=nil {return nil ,_gcca ;
};_ea ,_gcca :=_e (string (_ece ),_bbce .Resources );if _gcca !=nil {return nil ,_gcca ;};_gcca =_bbce .SetContentStream (_ea ,nil );if _gcca !=nil {return nil ,_gcca ;};_ =_bbce .ToPdfObject ();};}else if _abd .IsShading (){_ddg :=_abd .GetAsShadingPattern ();
_bfeg ,_bec :=_ebf (_ddg .Shading );if _bec !=nil {return nil ,_bec ;};_ddg .Shading =_bfeg ;_ =_ddg .ToPdfObject ();};return _abd ,nil ;};func _ebf (_ddd *_a .PdfShading )(*_a .PdfShading ,error ){_fcd :=_ddd .ColorSpace ;if _fcd .GetNumComponents ()==1{return _ddd ,nil ;
}else if _fcd .GetNumComponents ()==3{_bfg :=&_a .PdfFunctionType4 {};_bfg .Domain =[]float64 {0,1,0,1,0,1};_bfg .Range =[]float64 {0,1};_fee :=_ce .NewPSProgram ();_fee .Append (_ce .MakeReal (0.11));_fee .Append (_ce .MakeOperand ("\u006d\u0075\u006c"));
_fee .Append (_ce .MakeOperand ("\u0065\u0078\u0063\u0068"));_fee .Append (_ce .MakeReal (0.59));_fee .Append (_ce .MakeOperand ("\u006d\u0075\u006c"));_fee .Append (_ce .MakeOperand ("\u0061\u0064\u0064"));_fee .Append (_ce .MakeOperand ("\u0065\u0078\u0063\u0068"));
_fee .Append (_ce .MakeReal (0.3));_fee .Append (_ce .MakeOperand ("\u006d\u0075\u006c"));_fee .Append (_ce .MakeOperand ("\u0061\u0064\u0064"));_bfg .Program =_fee ;_dgbc :=_a .NewPdfColorspaceDeviceN ();_dgbc .AlternateSpace =_a .NewPdfColorspaceDeviceGray ();
_dgbc .ColorantNames =_b .MakeArray (_b .MakeName ("\u0052"),_b .MakeName ("\u0047"),_b .MakeName ("\u0042"));_dgbc .TintTransform =_bfg ;_ddd .ColorSpace =_dgbc ;return _ddd ,nil ;}else if _fcd .GetNumComponents ()==4{_eab :=&_a .PdfFunctionType4 {};_eab .Domain =[]float64 {0,1,0,1,0,1,0,1};
_eab .Range =[]float64 {0,1};_fdc :=_ce .NewPSProgram ();_fdc .Append (_ce .MakeOperand ("\u0065\u0078\u0063\u0068"));_fdc .Append (_ce .MakeReal (0.11));_fdc .Append (_ce .MakeOperand ("\u006d\u0075\u006c"));_fdc .Append (_ce .MakeOperand ("\u0061\u0064\u0064"));
_fdc .Append (_ce .MakeOperand ("\u0065\u0078\u0063\u0068"));_fdc .Append (_ce .MakeReal (0.59));_fdc .Append (_ce .MakeOperand ("\u006d\u0075\u006c"));_fdc .Append (_ce .MakeOperand ("\u0061\u0064\u0064"));_fdc .Append (_ce .MakeOperand ("\u0065\u0078\u0063\u0068"));
_fdc .Append (_ce .MakeReal (0.30));_fdc .Append (_ce .MakeOperand ("\u006d\u0075\u006c"));_fdc .Append (_ce .MakeOperand ("\u0061\u0064\u0064"));_fdc .Append (_ce .MakeOperand ("\u0064\u0075\u0070"));_fdc .Append (_ce .MakeReal (1.0));_fdc .Append (_ce .MakeOperand ("\u0067\u0065"));
_cfc :=_ce .NewPSProgram ();_cfc .Append (_ce .MakeOperand ("\u0070\u006f\u0070"));_cfc .Append (_ce .MakeReal (1.0));_fdc .Append (_cfc );_fdc .Append (_ce .MakeOperand ("\u0069\u0066"));_eab .Program =_fdc ;_bfgg :=_a .NewPdfColorspaceDeviceN ();_bfgg .AlternateSpace =_a .NewPdfColorspaceDeviceGray ();
_bfgg .ColorantNames =_b .MakeArray (_b .MakeName ("\u0043"),_b .MakeName ("\u004d"),_b .MakeName ("\u0059"),_b .MakeName ("\u004b"));_bfgg .TintTransform =_eab ;_ddd .ColorSpace =_bfgg ;return _ddd ,nil ;}else {return nil ,_cg .New ("\u0055\u006e\u0073\u0075\u0070\u0070\u006fr\u0074\u0065\u0064 \u0070\u0061\u0074t\u0065\u0072n\u0020\u0063\u006f\u006c\u006f\u0072s\u0070ac\u0065\u0020\u0066\u006f\u0072\u0020\u0067\u0072\u0061\u0079\u0073\u0063\u0061\u006c\u0065\u0020\u0063\u006f\u006e\u0076\u0065\u0072\u0073\u0069\u006f\u006e");
};};

// NormalizePage performs the following operations on the passed in page:
//   - Normalize the page rotation.
//     Rotates the contents of the page according to the Rotate entry, thus
//     flattening the rotation. The Rotate entry of the page is set to nil.
//   - Normalize the media box.
//     If the media box of the page is offsetted (Llx != 0 or Lly != 0),
//     the contents of the page are translated to (-Llx, -Lly). After
//     normalization, the media box is updated (Llx and Lly are set to 0 and
//     Urx and Ury are updated accordingly).
//   - Normalize the crop box.
//     The crop box of the page is updated based on the previous operations.
//
// After normalization, the page should look the same if openend using a
// PDF viewer.
// NOTE: This function does not normalize annotations, outlines other parts
// that are not part of the basic geometry and page content streams.
func NormalizePage (page *_a .PdfPage )error {_aaa ,_cegf :=page .GetMediaBox ();if _cegf !=nil {return _cegf ;};_edb ,_cegf :=page .GetRotate ();if _cegf !=nil {_db .Log .Debug ("\u0045\u0052R\u004f\u0052\u003a\u0020\u0025\u0073\u0020\u002d\u0020\u0069\u0067\u006e\u006f\u0072\u0069\u006e\u0067\u0020\u0061\u006e\u0064\u0020\u0061\u0073\u0073\u0075\u006d\u0069\u006e\u0067\u0020\u006e\u006f\u0020\u0072\u006f\u0074\u0061\u0074\u0069\u006f\u006e\u000a",_cegf .Error ());
};_eca :=_edb %360!=0&&_edb %90==0;_aaa .Normalize ();_ccf ,_fgbf ,_gga ,_ddf :=_aaa .Llx ,_aaa .Lly ,_aaa .Width (),_aaa .Height ();_gagf :=_ccf !=0||_fgbf !=0;if !_eca &&!_gagf {return nil ;};_efbf :=func (_aef ,_bfed ,_dgdd float64 )_d .BoundingBox {return _d .Path {Points :[]_d .Point {_d .NewPoint (0,0).Rotate (_dgdd ),_d .NewPoint (_aef ,0).Rotate (_dgdd ),_d .NewPoint (0,_bfed ).Rotate (_dgdd ),_d .NewPoint (_aef ,_bfed ).Rotate (_dgdd )}}.GetBoundingBox ();
};_gd :=_g .NewContentCreator ();var _bba float64 ;if _eca {_bba =-float64 (_edb );_cfd :=_efbf (_gga ,_ddf ,_bba );_gd .Translate ((_cfd .Width -_gga )/2+_gga /2,(_cfd .Height -_ddf )/2+_ddf /2);_gd .RotateDeg (_bba );_gd .Translate (-_gga /2,-_ddf /2);
_gga ,_ddf =_cfd .Width ,_cfd .Height ;};if _gagf {_gd .Translate (-_ccf ,-_fgbf );};_gbdg :=_gd .Operations ();_cgg ,_cegf :=_b .MakeStream (_gbdg .Bytes (),_b .NewFlateEncoder ());if _cegf !=nil {return _cegf ;};_ded :=_b .MakeArray (_cgg );_ded .Append (page .GetContentStreamObjs ()...);
*_aaa =_a .PdfRectangle {Urx :_gga ,Ury :_ddf };if _bbde :=page .CropBox ;_bbde !=nil {_bbde .Normalize ();_bed ,_edde ,_afeb ,_bgb :=_bbde .Llx -_ccf ,_bbde .Lly -_fgbf ,_bbde .Width (),_bbde .Height ();if _eca {_cbgb :=_efbf (_afeb ,_bgb ,_bba );_afeb ,_bgb =_cbgb .Width ,_cbgb .Height ;
};*_bbde =_a .PdfRectangle {Llx :_bed ,Lly :_edde ,Urx :_bed +_afeb ,Ury :_edde +_bgb };};_db .Log .Debug ("\u0052\u006f\u0074\u0061\u0074\u0065\u003d\u0025\u0066\u00b0\u0020\u004f\u0070\u0073\u003d%\u0071 \u004d\u0065\u0064\u0069\u0061\u0042\u006f\u0078\u003d\u0025\u002e\u0032\u0066",_bba ,_gbdg ,_aaa );
page .Contents =_ded ;page .Rotate =nil ;return nil ;};func _e (_gc string ,_fd *_a .PdfPageResources )([]byte ,error ){_fb :=_g .NewContentStreamParser (_gc );_ec ,_cef :=_fb .Parse ();if _cef !=nil {return nil ,_cef ;};_fe :=&_g .ContentStreamOperations {};
_ae :=map[_b .PdfObjectName ]bool {};_fbg :=map[_b .PdfObjectName ]bool {};_cc :=_g .NewContentStreamProcessor (*_ec );_cc .AddHandler (_g .HandlerConditionEnumAllOperands ,"",func (_fdf *_g .ContentStreamOperation ,_df _g .GraphicsState ,_bg *_a .PdfPageResources )error {_ef :=_fdf .Operand ;
switch _ef {case "\u0043\u0053":if _ca (_df .ColorspaceStroking ){_gcc :=_fdf .Params [0].(*_b .PdfObjectName );if *_gcc !="\u0050a\u0074\u0074\u0065\u0072\u006e"{_ad ,_efc :=_bg .GetColorspaceByName (*_gcc );if !_efc {return _cg .New ("\u0043\u006f\u006c\u006frs\u0070\u0061\u0063\u0065\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");
};_af ,_efc :=_ad .(*_a .PdfColorspaceSpecialPattern );if !_efc {return _cg .New ("\u0054\u0079\u0070\u0065\u0020\u0065\u0072\u0072\u006f\u0072");};if _af .UnderlyingCS !=nil {_af .UnderlyingCS =_a .NewPdfColorspaceDeviceGray ();};_cef =_bg .SetColorspaceByName (*_gcc ,_af );
if _cef !=nil {return _cef ;};};*_fe =append (*_fe ,_fdf );return nil ;};_bb :=_g .ContentStreamOperation {};_bb .Operand =_ef ;_bb .Params =[]_b .PdfObject {_b .MakeName ("\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079")};*_fe =append (*_fe ,&_bb );
return nil ;case "\u0063\u0073":if _ca (_df .ColorspaceNonStroking ){_dbd :=_fdf .Params [0].(*_b .PdfObjectName );if *_dbd !="\u0050a\u0074\u0074\u0065\u0072\u006e"{_ff ,_cee :=_bg .GetColorspaceByName (*_dbd );if !_cee {return _cg .New ("\u0043\u006f\u006c\u006frs\u0070\u0061\u0063\u0065\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");
};_aa ,_cee :=_ff .(*_a .PdfColorspaceSpecialPattern );if !_cee {return _cg .New ("\u0054\u0079\u0070\u0065\u0020\u0065\u0072\u0072\u006f\u0072");};if _aa .UnderlyingCS !=nil {_aa .UnderlyingCS =_a .NewPdfColorspaceDeviceGray ();};if _eb :=_bg .SetColorspaceByName (*_dbd ,_aa );
_eb !=nil {return _eb ;};};*_fe =append (*_fe ,_fdf );return nil ;};_gg :=_g .ContentStreamOperation {};_gg .Operand =_ef ;_gg .Params =[]_b .PdfObject {_b .MakeName ("\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079")};*_fe =append (*_fe ,&_gg );
return nil ;case "\u0053\u0043","\u0053\u0043\u004e":if _ca (_df .ColorspaceStroking ){_de :=_g .ContentStreamOperation {};_de .Operand =_ef ;_de .Params =[]_b .PdfObject {};_cb ,_cad :=_df .ColorStroking .(*_a .PdfColorPattern );if !_cad {return _cg .New ("I\u006e\u0076\u0061\u006c\u0069\u0064 \u0073\u0074\u0072\u006f\u006b\u0069\u006e\u0067\u0020c\u006f\u006c\u006fr\u0020t\u0079\u0070\u0065");
};if _cb .Color !=nil {_gcd ,_dec :=_df .ColorspaceStroking .ColorToRGB (_cb .Color );if _dec !=nil {return _dec ;};_efb :=_gcd .(*_a .PdfColorDeviceRGB );_fda :=_efb .ToGray ();_de .Params =append (_de .Params ,_b .MakeFloat (_fda .Val ()));};if _ ,_cgb :=_ae [_cb .PatternName ];
_cgb {_de .Params =append (_de .Params ,_b .MakeName (string (_cb .PatternName )));*_fe =append (*_fe ,&_de );return nil ;};_ae [_cb .PatternName ]=true ;_ga ,_aff :=_bg .GetPatternByName (_cb .PatternName );if !_aff {return _cg .New ("\u0055\u006e\u0064\u0065fi\u006e\u0065\u0064\u0020\u0070\u0061\u0074\u0074\u0065\u0072\u006e\u0020\u006e\u0061m\u0065");
};_da ,_aed :=_adc (_ga );if _aed !=nil {return _aed ;};_aed =_bg .SetPatternByName (_cb .PatternName ,_da .ToPdfObject ());if _aed !=nil {return _aed ;};_de .Params =append (_de .Params ,_b .MakeName (string (_cb .PatternName )));*_fe =append (*_fe ,&_de );
}else {_bd ,_dbg :=_df .ColorspaceStroking .ColorToRGB (_df .ColorStroking );if _dbg !=nil {return _dbg ;};_fea :=_bd .(*_a .PdfColorDeviceRGB );_fc :=_fea .ToGray ();_dc :=_g .ContentStreamOperation {};_dc .Operand =_ef ;_dc .Params =[]_b .PdfObject {_b .MakeFloat (_fc .Val ())};
*_fe =append (*_fe ,&_dc );};return nil ;case "\u0073\u0063","\u0073\u0063\u006e":if _ca (_df .ColorspaceNonStroking ){_dg :=_g .ContentStreamOperation {};_dg .Operand =_ef ;_dg .Params =[]_b .PdfObject {};_ed ,_cbc :=_df .ColorNonStroking .(*_a .PdfColorPattern );
if !_cbc {return _cg .New ("I\u006e\u0076\u0061\u006c\u0069\u0064 \u0073\u0074\u0072\u006f\u006b\u0069\u006e\u0067\u0020c\u006f\u006c\u006fr\u0020t\u0079\u0070\u0065");};if _ed .Color !=nil {_ceg ,_edd :=_df .ColorspaceNonStroking .ColorToRGB (_ed .Color );
if _edd !=nil {return _edd ;};_ebe :=_ceg .(*_a .PdfColorDeviceRGB );_afe :=_ebe .ToGray ();_dg .Params =append (_dg .Params ,_b .MakeFloat (_afe .Val ()));};if _ ,_gbe :=_ae [_ed .PatternName ];_gbe {_dg .Params =append (_dg .Params ,_b .MakeName (string (_ed .PatternName )));
*_fe =append (*_fe ,&_dg );return nil ;};_ae [_ed .PatternName ]=true ;_ggc ,_dbge :=_bg .GetPatternByName (_ed .PatternName );if !_dbge {return _cg .New ("\u0055\u006e\u0064\u0065fi\u006e\u0065\u0064\u0020\u0070\u0061\u0074\u0074\u0065\u0072\u006e\u0020\u006e\u0061m\u0065");
};_gbf ,_dgb :=_adc (_ggc );if _dgb !=nil {return _dgb ;};_dgb =_bg .SetPatternByName (_ed .PatternName ,_gbf .ToPdfObject ());if _dgb !=nil {return _dgb ;};_dg .Params =append (_dg .Params ,_b .MakeName (string (_ed .PatternName )));*_fe =append (*_fe ,&_dg );
}else {_fdaf ,_dfc :=_df .ColorspaceNonStroking .ColorToRGB (_df .ColorNonStroking );if _dfc !=nil {return _dfc ;};_cag :=_fdaf .(*_a .PdfColorDeviceRGB );_eeg :=_cag .ToGray ();_cadd :=_g .ContentStreamOperation {};_cadd .Operand =_ef ;_cadd .Params =[]_b .PdfObject {_b .MakeFloat (_eeg .Val ())};
*_fe =append (*_fe ,&_cadd );};return nil ;case "\u0052\u0047","\u004b":_ge ,_bbd :=_df .ColorspaceStroking .ColorToRGB (_df .ColorStroking );if _bbd !=nil {return _bbd ;};_be :=_ge .(*_a .PdfColorDeviceRGB );_ggf :=_be .ToGray ();_ab :=_g .ContentStreamOperation {};
_ab .Operand ="\u0047";_ab .Params =[]_b .PdfObject {_b .MakeFloat (_ggf .Val ())};*_fe =append (*_fe ,&_ab );return nil ;case "\u0072\u0067","\u006b":_bc ,_aee :=_df .ColorspaceNonStroking .ColorToRGB (_df .ColorNonStroking );if _aee !=nil {return _aee ;
};_cce :=_bc .(*_a .PdfColorDeviceRGB );_dgc :=_cce .ToGray ();_adf :=_g .ContentStreamOperation {};_adf .Operand ="\u0067";_adf .Params =[]_b .PdfObject {_b .MakeFloat (_dgc .Val ())};*_fe =append (*_fe ,&_adf );return nil ;case "\u0073\u0068":if len (_fdf .Params )!=1{return _cg .New ("\u0050\u0061\u0072\u0061\u006d\u0073 \u0074\u006f\u0020\u0073\u0068\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006fr\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0031");
};_gag ,_fce :=_fdf .Params [0].(*_b .PdfObjectName );if !_fce {return _cg .New ("\u0073\u0068 \u0070\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0020\u0073\u0068\u006f\u0075\u006c\u0064\u0020\u0062\u0065\u0020\u0061\u0020na\u006d\u0065");};if _ ,_dcg :=_fbg [*_gag ];
_dcg {*_fe =append (*_fe ,_fdf );return nil ;};_fbg [*_gag ]=true ;_gba ,_ede :=_bg .GetShadingByName (*_gag );if !_ede {return _cg .New ("\u0053\u0068\u0061\u0064\u0069\u006e\u0067\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066i\u006ee\u0064\u0020\u0069\u006e\u0020\u0072\u0065\u0073\u006f\u0075\u0072\u0063\u0065\u0073");
};_ged ,_dbbe :=_ebf (_gba );if _dbbe !=nil {return _dbbe ;};_dbbe =_bg .SetShadingByName (*_gag ,_ged .GetContext ().ToPdfObject ());if _dbbe !=nil {return _dbbe ;};};*_fe =append (*_fe ,_fdf );return nil ;});_cc .AddHandler (_g .HandlerConditionEnumOperand ,"\u0042\u0049",func (_cd *_g .ContentStreamOperation ,_cbb _g .GraphicsState ,_ceea *_a .PdfPageResources )error {if len (_cd .Params )!=1{return _cg .New ("\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0020o\u0066 \u0070\u0061\u0072\u0061\u006d\u0065\u0074e\u0072\u0073");
};_bca ,_dfb :=_cd .Params [0].(*_g .ContentStreamInlineImage );if !_dfb {return _cg .New ("\u0049\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0069\u006el\u0069\u006e\u0065\u0020\u0069\u006d\u0061g\u0065\u0020\u0070\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072");
};_adg ,_dbbc :=_bca .ToImage (_ceea );if _dbbc !=nil {return _dbbc ;};_cf ,_dbbc :=_bca .GetColorSpace (_ceea );if _dbbc !=nil {return _dbbc ;};_ccc ,_dbbc :=_cf .ImageToRGB (*_adg );if _dbbc !=nil {return _dbbc ;};_affd :=_a .NewPdfColorspaceDeviceRGB ();
_efbd ,_dbbc :=_affd .ImageToGray (_ccc );if _dbbc !=nil {return _dbbc ;};_cgf ,_dbbc :=_bca .GetEncoder ();if _dbbc !=nil {return _dbbc ;};if _aag ,_ebd :=_cgf .(*_b .DCTEncoder );_ebd {_aag .ColorComponents =1;};_abc ,_dbbc :=_g .NewInlineImageFromImage (_efbd ,_cgf );
if _dbbc !=nil {if _dbbc ==_b .ErrUnsupportedEncodingParameters {_cgf =_b .NewFlateEncoder ();};_abc ,_dbbc =_g .NewInlineImageFromImage (_efbd ,_cgf );if _dbbc !=nil {return _dbbc ;};};_gcce :=_g .ContentStreamOperation {};_gcce .Operand ="\u0042\u0049";
_gcce .Params =[]_b .PdfObject {_abc };*_fe =append (*_fe ,&_gcce );return nil ;});_fed :=map[string ]bool {};_cc .AddHandler (_g .HandlerConditionEnumOperand ,"\u0044\u006f",func (_baf *_g .ContentStreamOperation ,_ac _g .GraphicsState ,_cbg *_a .PdfPageResources )error {if len (_baf .Params )< 1{return _cg .New ("\u0045\u0052\u0052\u004f\u0052\u003a\u0020\u0049\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006e\u0075\u006d\u0062\u0065r\u0020\u006f\u0066\u0020\u0070\u0061\u0072\u0061\u006ds\u0020\u0066\u006f\u0072\u0020\u0044\u006f\u0020\u006f\u0062\u006a\u0065\u0063t\u003a\u0020\u0052\u0061\u006e\u0067e\u0020\u0063\u0068e\u0063\u006b");
};_bbc :=_baf .Params [0].(*_b .PdfObjectName );_ ,_acb :=_fed [string (*_bbc )];if _acb {return nil ;};_fed [string (*_bbc )]=true ;_ ,_abad :=_cbg .GetXObjectByName (*_bbc );if _abad ==_a .XObjectTypeImage {_eg ,_cdc :=_cbg .GetXObjectImageByName (*_bbc );
if _cdc !=nil {return _cdc ;};_dd ,_cdc :=_eg .ToImage ();if _cdc !=nil {return _cdc ;};_bgf ,_cdc :=_eg .ColorSpace .ImageToRGB (*_dd );if _cdc !=nil {return _cdc ;};_fg :=_a .NewPdfColorspaceDeviceRGB ();_ccg ,_cdc :=_fg .ImageToGray (_bgf );if _cdc !=nil {return _cdc ;
};_dgd :=_eg .Filter ;if _gac ,_gbc :=_dgd .(*_b .DCTEncoder );_gbc {_gac .ColorComponents =1;};_fbga ,_cdc :=_a .NewXObjectImageFromImage (&_ccg ,nil ,_dgd );if _cdc !=nil {if _cdc ==_b .ErrUnsupportedEncodingParameters {_dgd =_b .NewFlateEncoder ();};
_fbga ,_cdc =_a .NewXObjectImageFromImage (&_ccg ,nil ,_dgd );if _cdc !=nil {return _cdc ;};};_cdc =_cbg .SetXObjectImageByName (*_bbc ,_fbga );if _cdc !=nil {return _cdc ;};}else if _abad ==_a .XObjectTypeForm {_edda ,_dde :=_cbg .GetXObjectFormByName (*_bbc );
if _dde !=nil {return _dde ;};_bf ,_dde :=_edda .GetContentStream ();if _dde !=nil {return _dde ;};_ddb :=_edda .Resources ;if _ddb ==nil {_ddb =_cbg ;};_gad ,_dde :=_e (string (_bf ),_ddb );if _dde !=nil {return _dde ;};_dde =_edda .SetContentStream (_gad ,nil );
if _dde !=nil {return _dde ;};_dde =_cbg .SetXObjectFormByName (*_bbc ,_edda );if _dde !=nil {return _dde ;};};return nil ;});_cef =_cc .Process (_fd );if _cef !=nil {return nil ,_cef ;};return _fe .Bytes (),nil ;};func _ca (_gf _a .PdfColorspace )bool {_ ,_cae :=_gf .(*_a .PdfColorspaceSpecialPattern );
return _cae };

// ConvertPageToGrayscale() replaces color objects on the page with grayscale ones.  Also references XObject Images and Forms
// to convert those to grayscale.
func ConvertPageToGrayscale (page *_a .PdfPage )error {_f ,_dbb :=page .GetAllContentStreams ();if _dbb !=nil {return _dbb ;};_ba ,_dbb :=_e (_f ,page .Resources );if _dbb !=nil {return _dbb ;};_dbb =page .SetContentStreams ([]string {string (_ba )},_b .NewFlateEncoder ());
if _dbb !=nil {return _dbb ;};return nil ;};