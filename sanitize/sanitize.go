//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package sanitize ;import (_b "github.com/unidoc/unipdf/v3/common";_ef "github.com/unidoc/unipdf/v3/core";);

// SanitizationOpts specifies the objects to be removed during sanitization.
type SanitizationOpts struct{

// JavaScript specifies wether JavaScript action should be removed. JavaScript Actions, section 12.6.4.16 of PDF32000_2008
JavaScript bool ;

// URI specifies if URI actions should be removed. 12.6.4.7 URI Actions, PDF32000_2008.
URI bool ;

// GoToR removes remote GoTo actions. 12.6.4.3 Remote Go-To Actions, PDF32000_2008.
GoToR bool ;

// GoTo specifies wether GoTo actions should be removed. 12.6.4.2 Go-To Actions, PDF32000_2008.
GoTo bool ;

// RenditionJS enables removing of `JS` entry from a Rendition Action.
// The `JS` entry has a value of text string or stream containing a JavaScript script that shall be executed when the action is triggered.
// 12.6.4.13 Rendition Actions Table 214, PDF32000_2008.
RenditionJS bool ;

// OpenAction removes OpenAction entry from the document catalog.
OpenAction bool ;

// Launch specifies wether Launch Action should be removed.
// A launch action launches an application or opens or prints a document.
// 12.6.4.5 Launch Actions, PDF32000_2008.
Launch bool ;};

// Optimize optimizes `objects` and returns updated list of objects.
func (_d *Sanitizer )Optimize (objects []_ef .PdfObject )([]_ef .PdfObject ,error ){return _d .processObjects (objects );};

// Sanitizer represents a sanitizer object.
// It implements the Optimizer interface to access the objects field from the writer.
type Sanitizer struct{_g SanitizationOpts ;_a map[string ]int ;};func (_fdb *Sanitizer )analyze (_gc []_ef .PdfObject ){_cea :=map[string ]int {};for _ ,_gbc :=range _gc {switch _afg :=_gbc .(type ){case *_ef .PdfIndirectObject :_bef ,_gf :=_ef .GetDict (_afg .PdfObject );
if _gf {if _cc ,_ff :=_ef .GetName (_bef .Get ("\u0054\u0079\u0070\u0065"));_ff &&*_cc =="\u0043a\u0074\u0061\u006c\u006f\u0067"{if _ ,_cba :=_ef .GetIndirect (_bef .Get ("\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e"));_cba {_cea ["\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e"]++;
};}else if _bbb ,_ba :=_ef .GetName (_bef .Get ("\u0053"));_ba {_cge :=_bbb .String ();if _cge =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"||_cge =="\u0055\u0052\u0049"||_cge =="\u0047\u006f\u0054\u006f"||_cge =="\u0047\u006f\u0054o\u0052"||_cge =="\u004c\u0061\u0075\u006e\u0063\u0068"{_cea [_cge ]++;
}else if _cge =="\u0052e\u006e\u0064\u0069\u0074\u0069\u006fn"{if _ ,_ada :=_ef .GetStream (_bef .Get ("\u004a\u0053"));_ada {_cea [_cge ]++;};};}else if _ffc :=_bef .Get ("\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074");_ffc !=nil {_cea ["\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"]++;
}else if _de ,_gac :=_ef .GetIndirect (_bef .Get ("\u0050\u0061\u0072\u0065\u006e\u0074"));_gac {if _dcg ,_edg :=_ef .GetDict (_de .PdfObject );_edg {if _aga ,_bc :=_ef .GetDict (_dcg .Get ("\u0041\u0041"));_bc {_bed :=_aga .Get ("\u004b");_dag ,_df :=_ef .GetIndirect (_bed );
if _df {if _ge ,_aad :=_ef .GetDict (_dag .PdfObject );_aad {if _caa ,_efg :=_ef .GetName (_ge .Get ("\u0053"));_efg &&*_caa =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"{_cea ["\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"]++;
}else if _ ,_fee :=_ef .GetString (_ge .Get ("\u004a\u0053"));_fee {_cea ["\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"]++;}else {_dcb :=_aga .Get ("\u0046");if _dcb !=nil {_gbg ,_bab :=_ef .GetIndirect (_dcb );if _bab {if _gff ,_aac :=_ef .GetDict (_gbg .PdfObject );
_aac {if _ccd ,_bad :=_ef .GetName (_gff .Get ("\u0053"));_bad {_ebf :=_ccd .String ();_cea [_ebf ]++;};};};};};};};};};};};};};_fdb ._a =_cea ;};

// GetSuspiciousObjects returns a count of each detected suspicious object.
func (_dg *Sanitizer )GetSuspiciousObjects ()map[string ]int {return _dg ._a };

// New returns a new sanitizer object.
func New (opts SanitizationOpts )*Sanitizer {return &Sanitizer {_g :opts }};func (_bg *Sanitizer )processObjects (_c []_ef .PdfObject )([]_ef .PdfObject ,error ){_ed :=[]_ef .PdfObject {};_bf :=_bg ._g ;for _ ,_bd :=range _c {switch _af :=_bd .(type ){case *_ef .PdfIndirectObject :_ae ,_da :=_ef .GetDict (_af );
if _da {if _ag ,_ee :=_ef .GetName (_ae .Get ("\u0054\u0079\u0070\u0065"));_ee &&*_ag =="\u0043a\u0074\u0061\u006c\u006f\u0067"{if _ ,_dab :=_ef .GetIndirect (_ae .Get ("\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e"));_dab &&_bf .OpenAction {_ae .Remove ("\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e");
};}else if _eg ,_gb :=_ef .GetName (_ae .Get ("\u0053"));_gb {switch *_eg {case "\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074":if _bf .JavaScript {if _eea ,_cf :=_ef .GetStream (_ae .Get ("\u004a\u0053"));_cf {_eb :=[]byte {};_cb ,_cg :=_ef .MakeStream (_eb ,nil );
if _cg ==nil {*_eea =*_cb ;};};_b .Log .Debug ("\u004a\u0061\u0076\u0061\u0073\u0063\u0072\u0069\u0070\u0074\u0020a\u0063\u0074\u0069\u006f\u006e\u0020\u0073\u006b\u0069\u0070p\u0065\u0064\u002e");continue ;};case "\u0055\u0052\u0049":if _bf .URI {_b .Log .Debug ("\u0055\u0052\u0049\u0020ac\u0074\u0069\u006f\u006e\u0020\u0073\u006b\u0069\u0070\u0070\u0065\u0064\u002e");
continue ;};case "\u0047\u006f\u0054\u006f":if _bf .GoTo {_b .Log .Debug ("G\u004fT\u004f\u0020\u0061\u0063\u0074\u0069\u006f\u006e \u0073\u006b\u0069\u0070pe\u0064\u002e");continue ;};case "\u0047\u006f\u0054o\u0052":if _bf .GoToR {_b .Log .Debug ("R\u0065\u006d\u006f\u0074\u0065\u0020G\u006f\u0054\u004f\u0020\u0061\u0063\u0074\u0069\u006fn\u0020\u0073\u006bi\u0070p\u0065\u0064\u002e");
continue ;};case "\u004c\u0061\u0075\u006e\u0063\u0068":if _bf .Launch {_b .Log .Debug ("\u004a\u0061\u0076\u0061\u0073\u0063\u0072\u0069\u0070\u0074\u0020a\u0063\u0074\u0069\u006f\u006e\u0020\u0073\u006b\u0069\u0070p\u0065\u0064\u002e");continue ;};case "\u0052e\u006e\u0064\u0069\u0074\u0069\u006fn":if _bb ,_ab :=_ef .GetStream (_ae .Get ("\u004a\u0053"));
_ab {_cbg :=[]byte {};_ce ,_edc :=_ef .MakeStream (_cbg ,nil );if _edc ==nil {*_bb =*_ce ;};};};}else if _ac :=_ae .Get ("\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074");_ac !=nil &&_bf .JavaScript {continue ;}else if _afd ,_aeg :=_ef .GetName (_ae .Get ("\u0054\u0079\u0070\u0065"));
_aeg &&*_afd =="\u0041\u006e\u006eo\u0074"&&_bf .JavaScript {if _aca ,_dc :=_ef .GetIndirect (_ae .Get ("\u0050\u0061\u0072\u0065\u006e\u0074"));_dc {if _aff ,_f :=_ef .GetDict (_aca .PdfObject );_f {if _efd ,_fe :=_ef .GetDict (_aff .Get ("\u0041\u0041"));
_fe {_ca ,_ebg :=_ef .GetIndirect (_efd .Get ("\u004b"));if _ebg {if _dac ,_fg :=_ef .GetDict (_ca .PdfObject );_fg {if _fd ,_aa :=_ef .GetName (_dac .Get ("\u0053"));_aa &&*_fd =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"{_dac .Clear ();
}else if _fb :=_efd .Get ("\u0046");_fb !=nil {if _caf ,_adf :=_ef .GetIndirect (_fb );_adf {if _fa ,_ga :=_ef .GetDict (_caf .PdfObject );_ga {if _fdf ,_be :=_ef .GetName (_fa .Get ("\u0053"));_be &&*_fdf =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"{_fa .Clear ();
};};};};};};};};};};};case *_ef .PdfObjectStream :_b .Log .Debug ("\u0070d\u0066\u0020\u006f\u0062j\u0065\u0063\u0074\u0020\u0073t\u0072e\u0061m\u0020\u0074\u0079\u0070\u0065\u0020\u0025T",_af );case *_ef .PdfObjectStreams :_b .Log .Debug ("\u0070\u0064\u0066\u0020\u006f\u0062\u006a\u0065\u0063\u0074\u0020s\u0074\u0072\u0065\u0061\u006d\u0073\u0020\u0074\u0079\u0070e\u0020\u0025\u0054",_af );
default:_b .Log .Debug ("u\u006e\u006b\u006e\u006fwn\u0020p\u0064\u0066\u0020\u006f\u0062j\u0065\u0063\u0074\u0020\u0025\u0054",_af );};_ed =append (_ed ,_bd );};_bg .analyze (_ed );return _ed ,nil ;};