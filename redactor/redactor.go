//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_c "errors";_dc "fmt";_cg "github.com/unidoc/unipdf/v3/common";_bd "github.com/unidoc/unipdf/v3/contentstream";_gd "github.com/unidoc/unipdf/v3/core";_b "github.com/unidoc/unipdf/v3/creator";_cd "github.com/unidoc/unipdf/v3/extractor";
_bg "github.com/unidoc/unipdf/v3/model";_g "io";_e "regexp";_ge "sort";_ec "strings";);func _dd (_ddb localSpanMarks ,_bad *_cd .TextMarkArray ,_baa *_bg .PdfFont ,_bcc ,_bgbg string )([]_gd .PdfObject ,error ){_egb :=_afcg (_bad );Tj ,_fbb :=_caa (_bad );
if _fbb !=nil {return nil ,_fbb ;};_edb :=len (_bcc );_dfb :=len (_egb );_agb :=-1;_dee :=_gd .MakeFloat (Tj );if _egb !=_bgbg {_fcg :=_ddb ._bead ;if _fcg ==0{_agb =_ec .LastIndex (_bcc ,_egb );}else {_agb =_ec .Index (_bcc ,_egb );};}else {_agb =_ec .Index (_bcc ,_egb );
};_dcf :=_agb +_dfb ;_cdb :=[]_gd .PdfObject {};if _agb ==0&&_dcf ==_edb {_cdb =append (_cdb ,_dee );}else if _agb ==0&&_dcf < _edb {_da :=_aaf (_bcc [_dcf :],_baa );_dfe :=_gd .MakeStringFromBytes (_da );_cdb =append (_cdb ,_dee ,_dfe );}else if _agb > 0&&_dcf >=_edb {_dge :=_aaf (_bcc [:_agb ],_baa );
_bada :=_gd .MakeStringFromBytes (_dge );_cdb =append (_cdb ,_bada ,_dee );}else if _agb > 0&&_dcf < _edb {_def :=_aaf (_bcc [:_agb ],_baa );_bbe :=_aaf (_bcc [_dcf :],_baa );_dga :=_gd .MakeStringFromBytes (_def );_agc :=_gd .MakeString (string (_bbe ));
_cdb =append (_cdb ,_dga ,_dee ,_agc );};return _cdb ,nil ;};func _eggc (_ffa []*matchedIndex )[]*targetMap {_dac :=make (map[string ][][]int );_gcfg :=[]*targetMap {};for _ ,_facc :=range _ffa {_edeg :=_facc ._ace ;_bcbg :=[]int {_facc ._ecd ,_facc ._bgg };
if _bdg ,_baab :=_dac [_edeg ];_baab {_dac [_edeg ]=append (_bdg ,_bcbg );}else {_dac [_edeg ]=[][]int {_bcbg };};};for _adg ,_dba :=range _dac {_acg :=&targetMap {_ccf :_adg ,_fgb :_dba };_gcfg =append (_gcfg ,_acg );};return _gcfg ;};func _afef (_afff ,_adef string )[]int {if len (_adef )==0{return nil ;
};var _bfaa []int ;for _aef :=0;_aef < len (_afff );{_gfad :=_ec .Index (_afff [_aef :],_adef );if _gfad < 0{return _bfaa ;};_bfaa =append (_bfaa ,_aef +_gfad );_aef +=_gfad +len (_adef );};return _bfaa ;};func _dgc (_deab string ,_cbb []replacement ,_abc *_bg .PdfFont )[]_gd .PdfObject {_dda :=[]_gd .PdfObject {};
_ecfg :=0;_feba :=_deab ;for _efc ,_efd :=range _cbb {_adf :=_efd ._fd ;_cef :=_efd ._a ;_gggg :=_efd ._cb ;_dgba :=_gd .MakeFloat (_cef );if _ecfg > _adf ||_adf ==-1{continue ;};_cddd :=_deab [_ecfg :_adf ];_bgdb :=_aaf (_cddd ,_abc );_ebadb :=_gd .MakeStringFromBytes (_bgdb );
_dda =append (_dda ,_ebadb );_dda =append (_dda ,_dgba );_fea :=_adf +len (_gggg );_feba =_deab [_fea :];_ecfg =_fea ;if _efc ==len (_cbb )-1{_bgdb =_aaf (_feba ,_abc );_ebadb =_gd .MakeStringFromBytes (_bgdb );_dda =append (_dda ,_ebadb );};};return _dda ;
};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_bg .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_ddg :reader ,_fbg :opts ,_gbe :_b .New (),_efb :rectProps };};func _bec (_edff *_cd .TextMarkArray ,_gfac int ,_ccb int )int {_gaaf :=_edff .Elements ();
_dag :=_gfac -1;_ada :=_gfac +1;_fgd :=-1;if _dag >=0{_dae :=_gaaf [_dag ];_ccfg :=_dae .ObjString ;_acef :=len (_ccfg );_afag :=_dae .Index ;if _afag +1< _acef {_fgd =_dag ;return _fgd ;};};if _ada < len (_gaaf ){_gce :=_gaaf [_ada ];_ccbd :=_gce .ObjString ;
if _ccbd [0]!=_gce .Text {_fgd =_ada ;return _fgd ;};};return _fgd ;};func _gfa (_dedc []placeHolders )[]replacement {_fcga :=[]replacement {};for _ ,_cdbe :=range _dedc {_fcc :=_cdbe ._bc ;_dcbe :=_cdbe ._ed ;_afde :=_cdbe ._f ;for _ ,_dccg :=range _fcc {_bag :=replacement {_cb :_dcbe ,_a :_afde ,_fd :_dccg };
_fcga =append (_fcga ,_bag );};};_ge .Slice (_fcga ,func (_ebdd ,_age int )bool {return _fcga [_ebdd ]._fd < _fcga [_age ]._fd });return _fcga ;};func _efdg (_caab ,_fgc ,_fdc float64 )float64 {_fdc =_fdc /100;_fgf :=(-1000*_caab )/(_fgc *_fdc );return _fgf ;
};type matchedIndex struct{_ecd int ;_bgg int ;_ace string ;};func _cbd (_ab *_bg .PdfFont ,_acb _cd .TextMark )float64 {_fba :=0.001;_bda :=_acb .Th /100;if _ab .Subtype ()=="\u0054\u0079\u0070e\u0033"{_fba =1;};_abd ,_fe :=_ab .GetRuneMetrics (' ');if !_fe {_abd ,_fe =_ab .GetCharMetrics (32);
};if !_fe {_abd ,_ =_bg .DefaultFont ().GetRuneMetrics (' ');};_efa :=_fba *((_abd .Wx *_acb .FontSize +_acb .Tc +_acb .Tw )/_bda );return _efa ;};func _eb (_gg *_bd .ContentStreamOperations ,_dce string ,_cc int )error {_agf :=_bd .ContentStreamOperations {};
var _de _bd .ContentStreamOperation ;for _bgd ,_egc :=range *_gg {if _bgd ==_cc {if _dce =="\u0027"{_gea :=_bd .ContentStreamOperation {Operand :"\u0054\u002a"};_agf =append (_agf ,&_gea );_de .Params =_egc .Params ;_de .Operand ="\u0054\u006a";_agf =append (_agf ,&_de );
}else if _dce =="\u0022"{_dea :=_egc .Params [:2];Tc ,Tw :=_dea [0],_dea [1];_bcd :=_bd .ContentStreamOperation {Params :[]_gd .PdfObject {Tc },Operand :"\u0054\u0063"};_agf =append (_agf ,&_bcd );_bcd =_bd .ContentStreamOperation {Params :[]_gd .PdfObject {Tw },Operand :"\u0054\u0077"};
_agf =append (_agf ,&_bcd );_de .Params =[]_gd .PdfObject {_egc .Params [2]};_de .Operand ="\u0054\u006a";_agf =append (_agf ,&_de );};};_agf =append (_agf ,_egc );};*_gg =_agf ;return nil ;};func _gbfe (_fgfb int ,_cdfg []int )bool {for _ ,_cgae :=range _cdfg {if _cgae ==_fgfb {return true ;
};};return false ;};func _aaf (_afe string ,_edcg *_bg .PdfFont )[]byte {_gbf ,_ebad :=_edcg .StringToCharcodeBytes (_afe );if _ebad !=0{_cg .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_afe ,_gbf );
};return _gbf ;};func _cfcd (_cga *targetMap ,_bega []int ){var _beaa [][]int ;for _cfe ,_cega :=range _cga ._fgb {if _gbfe (_cfe ,_bega ){continue ;};_beaa =append (_beaa ,_cega );};_cga ._fgb =_beaa ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_b .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_e .Regexp ;};func _afcg (_gggb *_cd .TextMarkArray )string {_cfcc :="";for _ ,_cbce :=range _gggb .Elements (){_cfcc +=_cbce .Text ;};return _cfcc ;};func _bge (_fegg RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_adab :_fegg },nil };
func _edea (_cbc *_cd .TextMarkArray )int {_eba :=0;_efg :=_cbc .Elements ();if _efg [0].Text =="\u0020"{_eba ++;};if _efg [_cbc .Len ()-1].Text =="\u0020"{_eba ++;};return _eba ;};func _cdfc (_geb []*targetMap ){for _bac ,_dbb :=range _geb {for _faa ,_bgaf :=range _geb {if _bac !=_faa {_ggggb ,_decd :=_deb (*_dbb ,*_bgaf );
if _ggggb {_cfcd (_bgaf ,_decd );};};};};};func _aafe (_gf *_bd .ContentStreamOperation ,_beg _gd .PdfObject ,_ade []localSpanMarks )error {var _bdee *_gd .PdfObjectArray ;_ged ,_eef :=_abb (_ade );if len (_eef )==1{_ead :=_eef [0];_aff :=_ged [_ead ];
if len (_aff )==1{_cce :=_aff [0];_gfc :=_cce ._gecb ;_gca :=_bdc (_gfc );_ggg ,_bb :=_ff (_beg ,_gca );if _bb !=nil {return _bb ;};_afg ,_bb :=_dd (_cce ,_gfc ,_gca ,_ggg ,_ead );if _bb !=nil {return _bb ;};_bdee =_gd .MakeArray (_afg ...);}else {_dcb :=_aff [0]._gecb ;
_ceg :=_bdc (_dcb );_dgd ,_afd :=_ff (_beg ,_ceg );if _afd !=nil {return _afd ;};_cff ,_afd :=_feb (_dgd ,_aff );if _afd !=nil {return _afd ;};_ba :=_gfa (_cff );_bef :=_dgc (_dgd ,_ba ,_ceg );_bdee =_gd .MakeArray (_bef ...);};}else if len (_eef )> 1{_bea :=_ade [0];
_fca :=_bea ._gecb ;_ ,_add :=_aa (_fca );_eag :=_fca .Elements ()[_add ];_dccf :=_eag .Font ;_cab ,_ceb :=_ff (_beg ,_dccf );if _ceb !=nil {return _ceb ;};_bgb ,_ceb :=_feb (_cab ,_ade );if _ceb !=nil {return _ceb ;};_bbg :=_gfa (_bgb );_eae :=_dgc (_cab ,_bbg ,_dccf );
_bdee =_gd .MakeArray (_eae ...);};_gf .Params [0]=_bdee ;_gf .Operand ="\u0054\u004a";return nil ;};func _bdc (_deag *_cd .TextMarkArray )*_bg .PdfFont {_ ,_eff :=_aa (_deag );_bgf :=_deag .Elements ()[_eff ];_fcf :=_bgf .Font ;return _fcf ;};func _bfag (_fdcb *matchedIndex ,_cgag [][]int )[]*matchedIndex {_dcg :=[]*matchedIndex {};
_deg :=_fdcb ._ecd ;_bbd :=_deg ;_dccd :=_fdcb ._ace ;_gccc :=0;for _ ,_dbae :=range _cgag {_dcad :=_dbae [0]-_deg ;if _gccc >=_dcad {continue ;};_edba :=_dccd [_gccc :_dcad ];_bfaae :=&matchedIndex {_ace :_edba ,_ecd :_bbd ,_bgg :_dbae [0]};if len (_ec .TrimSpace (_edba ))!=0{_dcg =append (_dcg ,_bfaae );
};_gccc =_dbae [1]-_deg ;_bbd =_deg +_gccc ;};_ggc :=_dccd [_gccc :];_fdef :=&matchedIndex {_ace :_ggc ,_ecd :_bbd ,_bgg :_fdcb ._bgg };if len (_ec .TrimSpace (_ggc ))!=0{_dcg =append (_dcg ,_fdef );};return _dcg ;};func _ac (_ea *_bd .ContentStreamOperations ,_ad map[_gd .PdfObject ][]localSpanMarks )error {for _bde ,_ee :=range _ad {if _bde ==nil {continue ;
};_eg ,_ede ,_df :=_ddae (_ea ,_bde );if !_df {_cg .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_bde ,_ea );
return nil ;};if _eg .Operand =="\u0054\u006a"{_ag :=_aafe (_eg ,_bde ,_ee );if _ag !=nil {return _ag ;};}else if _eg .Operand =="\u0054\u004a"{_bdf :=_gdb (_eg ,_bde ,_ee );if _bdf !=nil {return _bdf ;};}else if _eg .Operand =="\u0027"||_eg .Operand =="\u0022"{_ef :=_eb (_ea ,_eg .Operand ,_ede );
if _ef !=nil {return _ef ;};_ef =_aafe (_eg ,_bde ,_ee );if _ef !=nil {return _ef ;};};};return nil ;};type localSpanMarks struct{_gecb *_cd .TextMarkArray ;_bead int ;_efdf string ;};func _egd (_fdd *matchedIndex ,_fef [][]int )(bool ,[][]int ){_fabf :=[][]int {};
for _ ,_aefe :=range _fef {if _fdd ._ecd < _aefe [0]&&_fdd ._bgg > _aefe [1]{_fabf =append (_fabf ,_aefe );};};return len (_fabf )> 0,_fabf ;};

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_aba *Redactor )WriteToFile (outputPath string )error {if _gdgc :=_aba ._gbe .WriteToFile (outputPath );_gdgc !=nil {return _dc .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};func _aa (_bga *_cd .TextMarkArray )(_gd .PdfObject ,int ){var _ggb _gd .PdfObject ;_be :=-1;for _edc ,_eab :=range _bga .Elements (){_ggb =_eab .DirectObject ;_be =_edc ;if _ggb !=nil {break ;};};return _ggb ,_be ;};func _deb (_dgge ,_edbd targetMap )(bool ,[]int ){_cceec :=_ec .Contains (_dgge ._ccf ,_edbd ._ccf );
var _bee []int ;for _ ,_efe :=range _dgge ._fgb {for _gbdg ,_gdc :=range _edbd ._fgb {if _gdc [0]>=_efe [0]&&_gdc [1]<=_efe [1]{_bee =append (_bee ,_gbdg );};};};return _cceec ,_bee ;};type replacement struct{_cb string ;_a float64 ;_fd int ;};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;};func _ddae (_eaf *_bd .ContentStreamOperations ,PdfObj _gd .PdfObject )(*_bd .ContentStreamOperation ,int ,bool ){for _ceff ,_gcd :=range *_eaf {_afc :=_gcd .Operand ;if _afc =="\u0054\u006a"{_cfc :=_gd .TraceToDirectObject (_gcd .Params [0]);
if _cfc ==PdfObj {return _gcd ,_ceff ,true ;};}else if _afc =="\u0054\u004a"{_aeg ,_dcag :=_gd .GetArray (_gcd .Params [0]);if !_dcag {return nil ,_ceff ,_dcag ;};for _ ,_adfg :=range _aeg .Elements (){if _adfg ==PdfObj {return _gcd ,_ceff ,true ;};};}else if _afc =="\u0022"{_eabe :=_gd .TraceToDirectObject (_gcd .Params [2]);
if _eabe ==PdfObj {return _gcd ,_ceff ,true ;};}else if _afc =="\u0027"{_bfb :=_gd .TraceToDirectObject (_gcd .Params [0]);if _bfb ==PdfObj {return _gcd ,_ceff ,true ;};};};return nil ,-1,false ;};func _ege (_dbe []int ,_faad *_cd .TextMarkArray ,_egcb string )(*_cd .TextMarkArray ,matchedBBox ,error ){_aac :=matchedBBox {};
_edf :=_dbe [0];_fdec :=_dbe [1];_ebg :=len (_egcb )-len (_ec .TrimLeft (_egcb ,"\u0020"));_dbg :=len (_egcb )-len (_ec .TrimRight (_egcb ,"\u0020\u000a"));_edf =_edf +_ebg ;_fdec =_fdec -_dbg ;_egcb =_ec .Trim (_egcb ,"\u0020\u000a");_gcf ,_cde :=_faad .RangeOffset (_edf ,_fdec );
if _cde !=nil {return nil ,_aac ,_cde ;};_cec ,_bcgd :=_gcf .BBox ();if !_bcgd {return nil ,_aac ,_dc .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_gcf );
};_aac =matchedBBox {_ccee :_egcb ,_abg :_cec };return _gcf ,_aac ,nil ;};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_abe *Redactor )Redact ()error {_gfda ,_fce :=_abe ._ddg .GetNumPages ();if _fce !=nil {return _dc .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};_cad :=_abe ._efb .FillColor ;_gaf :=_abe ._efb .BorderWidth ;_gfcf :=_abe ._efb .FillOpacity ;for _ageb :=1;_ageb <=_gfda ;_ageb ++{_dcca ,_cdg :=_abe ._ddg .GetPage (_ageb );if _cdg !=nil {return _cdg ;};_fdg ,_cdg :=_cd .New (_dcca );if _cdg !=nil {return _cdg ;
};_ebdb ,_ ,_ ,_cdg :=_fdg .ExtractPageText ();if _cdg !=nil {return _cdg ;};_fac :=_ebdb .GetContentStreamOps ();_cgc ,_cabd ,_cdg :=_abe .redactPage (_fac ,_dcca .Resources );if _cabd ==nil {_cg .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_cabd =_fac ;};_ddd :=_bd .ContentStreamOperation {Operand :"\u006e"};*_cabd =append (*_cabd ,&_ddd );_dcca .SetContentStreams ([]string {_cabd .String ()},_gd .NewFlateEncoder ());if _cdg !=nil {return _cdg ;};_fbed ,_cdg :=_dcca .GetMediaBox ();if _cdg !=nil {return _cdg ;
};if _dcca .MediaBox ==nil {_dcca .MediaBox =_fbed ;};if _gbef :=_abe ._gbe .AddPage (_dcca );_gbef !=nil {return _gbef ;};_ge .Slice (_cgc ,func (_bfc ,_eabd int )bool {return _cgc [_bfc ]._ccee < _cgc [_eabd ]._ccee });_bdcf :=_fbed .Ury ;for _ ,_bff :=range _cgc {_fag :=_bff ._abg ;
_ceef :=_abe ._gbe .NewRectangle (_fag .Llx ,_bdcf -_fag .Lly ,_fag .Urx -_fag .Llx ,-(_fag .Ury -_fag .Lly ));_ceef .SetFillColor (_cad );_ceef .SetBorderWidth (_gaf );_ceef .SetFillOpacity (_gfcf );if _aae :=_abe ._gbe .Draw (_ceef );_aae !=nil {return nil ;
};};};_abe ._gbe .SetOutlineTree (_abe ._ddg .GetOutlineTree ());return nil ;};func (_afee *regexMatcher )match (_defbd string )([]*matchedIndex ,error ){_cddc :=_afee ._adab .Pattern ;if _cddc ==nil {return nil ,_c .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");
};var (_dab =_cddc .FindAllStringIndex (_defbd ,-1);_ccgd []*matchedIndex ;);for _ ,_dbd :=range _dab {_ccgd =append (_ccgd ,&matchedIndex {_ecd :_dbd [0],_bgg :_dbd [1],_ace :_defbd [_dbd [0]:_dbd [1]]});};return _ccgd ,nil ;};func _ff (_fff _gd .PdfObject ,_eafb *_bg .PdfFont )(string ,error ){_aded ,_fda :=_gd .GetStringBytes (_fff );
if !_fda {return "",_gd .ErrTypeError ;};_fbag :=_eafb .BytesToCharcodes (_aded );_fa ,_dec ,_gad :=_eafb .CharcodesToStrings (_fbag ,"");if _gad > 0{_cg .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_dec ,_gad );
};_bgbb :=_ec .Join (_fa ,"");return _bgbb ,nil ;};func _caa (_db *_cd .TextMarkArray )(float64 ,error ){_aec ,_baad :=_db .BBox ();if !_baad {return 0.0,_dc .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_db );
};_gfd :=_edea (_db );_ebbf :=0.0;_ ,_bddd :=_aa (_db );_dde :=_db .Elements ()[_bddd ];_fbe :=_dde .Font ;if _gfd > 0{_ebbf =_cbd (_fbe ,_dde );};_bddg :=(_aec .Urx -_aec .Llx );_bddg =_bddg +_ebbf *float64 (_gfd );Tj :=_efdg (_bddg ,_dde .FontSize ,_dde .Th );
return Tj ,nil ;};type regexMatcher struct{_adab RedactionTerm };func _bdcg (_befc string )(string ,[][]int ){_ccfc :=_e .MustCompile ("\u005c\u006e");_dfa :=_ccfc .FindAllStringIndex (_befc ,-1);_aafed :=_ccfc .ReplaceAllString (_befc ,"\u0020");return _aafed ,_dfa ;
};func _fad (_cbe *_cd .TextMarkArray )[]*_cd .TextMarkArray {_cfb :=_cbe .Elements ();_ega :=len (_cfb );var _ccbg _gd .PdfObject ;_dcab :=[]*_cd .TextMarkArray {};_edd :=&_cd .TextMarkArray {};_aad :=-1;for _cge ,_aee :=range _cfb {_afgc :=_aee .DirectObject ;
_aad =_aee .Index ;if _afgc ==nil {_caf :=_bec (_cbe ,_cge ,_aad );if _ccbg !=nil {if _caf ==-1||_caf > _cge {_dcab =append (_dcab ,_edd );_edd =&_cd .TextMarkArray {};};};}else if _afgc !=nil &&_ccbg ==nil {if _aad ==0&&_cge > 0{_dcab =append (_dcab ,_edd );
_edd =&_cd .TextMarkArray {};};}else if _afgc !=nil &&_ccbg !=nil {if _afgc !=_ccbg {_dcab =append (_dcab ,_edd );_edd =&_cd .TextMarkArray {};};};_ccbg =_afgc ;_edd .Append (_aee );if _cge ==(_ega -1){_dcab =append (_dcab ,_edd );};};return _dcab ;};func _dfee (_bbea []*matchedIndex ,_bfbd [][]int )[]*matchedIndex {_fgcf :=[]*matchedIndex {};
for _ ,_abgf :=range _bbea {_cea ,_feac :=_egd (_abgf ,_bfbd );if _cea {_fcaa :=_bfag (_abgf ,_feac );_fgcf =append (_fgcf ,_fcaa ...);}else {_fgcf =append (_fgcf ,_abgf );};};return _fgcf ;};type targetMap struct{_ccf string ;_fgb [][]int ;};type placeHolders struct{_bc []int ;
_ed string ;_f float64 ;};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_bab *Redactor )Write (writer _g .Writer )error {return _bab ._gbe .Write (writer )};func (_gbd *Redactor )redactPage (_eaea *_bd .ContentStreamOperations ,_eac *_bg .PdfPageResources )([]matchedBBox ,*_bd .ContentStreamOperations ,error ){_dgf ,_ccfb :=_cd .NewFromContents (_eaea .String (),_eac );
if _ccfb !=nil {return nil ,nil ,_ccfb ;};_ddf ,_ ,_ ,_ccfb :=_dgf .ExtractPageText ();if _ccfb !=nil {return nil ,nil ,_ccfb ;};_eaea =_ddf .GetContentStreamOps ();_gecc :=_ddf .Marks ();_dedca :=_ddf .Text ();_dedca ,_fee :=_bdcg (_dedca );_gaab :=[]matchedBBox {};
_aeb :=make (map[_gd .PdfObject ][]localSpanMarks );_bfef :=[]*targetMap {};for _ ,_gda :=range _gbd ._fbg .Terms {_afa ,_gdg :=_bge (_gda );if _gdg !=nil {return nil ,nil ,_gdg ;};_ddgb ,_gdg :=_afa .match (_dedca );if _gdg !=nil {return nil ,nil ,_gdg ;
};_ddgb =_dfee (_ddgb ,_fee );_bfcc :=_eggc (_ddgb );_bfef =append (_bfef ,_bfcc ...);};_cdfc (_bfef );for _ ,_agef :=range _bfef {_ddfd :=_agef ._ccf ;_gcc :=_agef ._fgb ;_agba :=[]matchedBBox {};for _ ,_cfd :=range _gcc {_gab ,_fab ,_aagf :=_ege (_cfd ,_gecc ,_ddfd );
if _aagf !=nil {return nil ,nil ,_aagf ;};_eca :=_fad (_gab );for _efaa ,_cdgc :=range _eca {_eaba :=localSpanMarks {_gecb :_cdgc ,_bead :_efaa ,_efdf :_ddfd };_cgb ,_ :=_aa (_cdgc );if _bfde ,_eadb :=_aeb [_cgb ];_eadb {_aeb [_cgb ]=append (_bfde ,_eaba );
}else {_aeb [_cgb ]=[]localSpanMarks {_eaba };};};_agba =append (_agba ,_fab );};_gaab =append (_gaab ,_agba ...);};_ccfb =_ac (_eaea ,_aeb );if _ccfb !=nil {return nil ,nil ,_ccfb ;};return _gaab ,_eaea ,nil ;};func _gdb (_dcc *_bd .ContentStreamOperation ,_adc _gd .PdfObject ,_ca []localSpanMarks )error {_ae ,_ga :=_gd .GetArray (_dcc .Params [0]);
_bdd :=[]_gd .PdfObject {};if !_ga {_cg .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_dcc );return _dc .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_dcc );
};_gb ,_ce :=_abb (_ca );if len (_ce )==1{_ccg :=_ce [0];_fde :=_gb [_ccg ];if len (_fde )==1{_bgda :=_fde [0];_bcf :=_bgda ._gecb ;_cdd :=_bdc (_bcf );_cf ,_cddb :=_ff (_adc ,_cdd );if _cddb !=nil {return _cddb ;};_ebd ,_cddb :=_dd (_bgda ,_bcf ,_cdd ,_cf ,_ccg );
if _cddb !=nil {return _cddb ;};for _ ,_ccc :=range _ae .Elements (){if _ccc ==_adc {_bdd =append (_bdd ,_ebd ...);}else {_bdd =append (_bdd ,_ccc );};};}else {_cee :=_fde [0]._gecb ;_gaa :=_bdc (_cee );_aed ,_ggbd :=_ff (_adc ,_gaa );if _ggbd !=nil {return _ggbd ;
};_ebf ,_ggbd :=_feb (_aed ,_fde );if _ggbd !=nil {return _ggbd ;};_cdf :=_gfa (_ebf );_bf :=_dgc (_aed ,_cdf ,_gaa );for _ ,_cdc :=range _ae .Elements (){if _cdc ==_adc {_bdd =append (_bdd ,_bf ...);}else {_bdd =append (_bdd ,_cdc );};};};_dcc .Params [0]=_gd .MakeArray (_bdd ...);
}else if len (_ce )> 1{_gge :=_ca [0];_dca :=_gge ._gecb ;_ ,_af :=_aa (_dca );_bdb :=_dca .Elements ()[_af ];_egg :=_bdb .Font ;_aag ,_bfd :=_ff (_adc ,_egg );if _bfd !=nil {return _bfd ;};_fb ,_bfd :=_feb (_aag ,_ca );if _bfd !=nil {return _bfd ;};_gdbb :=_gfa (_fb );
_cba :=_dgc (_aag ,_gdbb ,_egg );for _ ,_gec :=range _ae .Elements (){if _gec ==_adc {_bdd =append (_bdd ,_cba ...);}else {_bdd =append (_bdd ,_gec );};};_dcc .Params [0]=_gd .MakeArray (_bdd ...);};return nil ;};func _feb (_bgbc string ,_ebb []localSpanMarks )([]placeHolders ,error ){_dgb :="";
_bbc :=[]placeHolders {};for _bcg ,_bdaf :=range _ebb {_egcd :=_bdaf ._gecb ;_bfa :=_bdaf ._efdf ;_bfe :=_afcg (_egcd );_cebe ,_bcb :=_caa (_egcd );if _bcb !=nil {return nil ,_bcb ;};if _bfe !=_dgb {var _ecf []int ;if _bcg ==0&&_bfa !=_bfe {_abf :=_ec .Index (_bgbc ,_bfe );
_ecf =[]int {_abf };}else if _bcg ==len (_ebb )-1{_adde :=_ec .LastIndex (_bgbc ,_bfe );_ecf =[]int {_adde };}else {_ecf =_afef (_bgbc ,_bfe );};_eagd :=placeHolders {_bc :_ecf ,_ed :_bfe ,_f :_cebe };_bbc =append (_bbc ,_eagd );};_dgb =_bfe ;};return _bbc ,nil ;
};

// Redactor represents a Redactor object.
type Redactor struct{_ddg *_bg .PdfReader ;_fbg *RedactionOptions ;_gbe *_b .Creator ;_efb *RectangleProps ;};func _abb (_acd []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_agd :=make (map[string ][]localSpanMarks );_ecc :=[]string {};for _ ,_fc :=range _acd {_fdb :=_fc ._efdf ;
if _fg ,_gbc :=_agd [_fdb ];_gbc {_agd [_fdb ]=append (_fg ,_fc );}else {_agd [_fdb ]=[]localSpanMarks {_fc };_ecc =append (_ecc ,_fdb );};};return _agd ,_ecc ;};type matchedBBox struct{_abg _bg .PdfRectangle ;_ccee string ;};

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _b .Color ;BorderWidth float64 ;FillOpacity float64 ;};