//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_be "errors";_b "fmt";_c "github.com/unidoc/unipdf/v3/common";_e "github.com/unidoc/unipdf/v3/contentstream";_dd "github.com/unidoc/unipdf/v3/core";_ad "github.com/unidoc/unipdf/v3/creator";_fb "github.com/unidoc/unipdf/v3/extractor";
_d "github.com/unidoc/unipdf/v3/model";_f "io";_a "regexp";_ab "sort";_bc "strings";);

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_ece *Redactor )WriteToFile (outputPath string )error {if _edad :=_ece ._gbeg .WriteToFile (outputPath );_edad !=nil {return _b .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};func _dae (_facc *_fb .TextMarkArray )[]*_fb .TextMarkArray {_aaa :=_facc .Elements ();_cef :=len (_aaa );var _dceg _dd .PdfObject ;_ffea :=[]*_fb .TextMarkArray {};_fcd :=&_fb .TextMarkArray {};_egga :=-1;for _dba ,_bdfc :=range _aaa {_geb :=_bdfc .DirectObject ;
_egga =_bdfc .Index ;if _geb ==nil {_ded :=_cfgb (_facc ,_dba ,_egga );if _dceg !=nil {if _ded ==-1||_ded > _dba {_ffea =append (_ffea ,_fcd );_fcd =&_fb .TextMarkArray {};};};}else if _geb !=nil &&_dceg ==nil {if _egga ==0&&_dba > 0{_ffea =append (_ffea ,_fcd );
_fcd =&_fb .TextMarkArray {};};}else if _geb !=nil &&_dceg !=nil {if _geb !=_dceg {_ffea =append (_ffea ,_fcd );_fcd =&_fb .TextMarkArray {};};};_dceg =_geb ;_fcd .Append (_bdfc );if _dba ==(_cef -1){_ffea =append (_ffea ,_fcd );};};return _ffea ;};func _bee (_fac _dd .PdfObject ,_bad *_d .PdfFont )(string ,error ){_gfb ,_gaf :=_dd .GetStringBytes (_fac );
if !_gaf {return "",_dd .ErrTypeError ;};_gbd :=_bad .BytesToCharcodes (_gfb );_ggaf ,_ggae ,_ggac :=_bad .CharcodesToStrings (_gbd ,"");if _ggac > 0{_c .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_ggae ,_ggac );
};_ddf :=_bc .Join (_ggaf ,"");return _ddf ,nil ;};func _gdd (_fdb ,_beb ,_fag float64 )float64 {_fag =_fag /100;_caaf :=(-1000*_fdb )/(_beb *_fag );return _caaf ;};type matchedBBox struct{_bbe _d .PdfRectangle ;_fgc string ;};func _gcba (_gfe ,_facg targetMap )(bool ,[]int ){_ffab :=_bc .Contains (_gfe ._dda ,_facg ._dda );
var _fgdb []int ;for _ ,_aga :=range _gfe ._bbeg {for _afaa ,_cdf :=range _facg ._bbeg {if _cdf [0]>=_aga [0]&&_cdf [1]<=_aga [1]{_fgdb =append (_fgdb ,_afaa );};};};return _ffab ,_fgdb ;};type targetMap struct{_dda string ;_bbeg [][]int ;};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_aadd *Redactor )Redact ()error {_ffad ,_eef :=_aadd ._fea .GetNumPages ();if _eef !=nil {return _b .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};_fdge :=_aadd ._eag .FillColor ;_ead :=_aadd ._eag .BorderWidth ;_bcfb :=_aadd ._eag .FillOpacity ;for _fgbd :=1;_fgbd <=_ffad ;_fgbd ++{_dccd ,_aadb :=_aadd ._fea .GetPage (_fgbd );if _aadb !=nil {return _aadb ;};_ffc ,_aadb :=_fb .New (_dccd );if _aadb !=nil {return _aadb ;
};_cdg ,_ ,_ ,_aadb :=_ffc .ExtractPageText ();if _aadb !=nil {return _aadb ;};_fed :=_cdg .GetContentStreamOps ();_bdab ,_eff ,_aadb :=_aadd .redactPage (_fed ,_dccd .Resources );if _eff ==nil {_c .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_eff =_fed ;};_dgg :=_e .ContentStreamOperation {Operand :"\u006e"};*_eff =append (*_eff ,&_dgg );_dccd .SetContentStreams ([]string {_eff .String ()},_dd .NewFlateEncoder ());if _aadb !=nil {return _aadb ;};_abebc ,_aadb :=_dccd .GetMediaBox ();if _aadb !=nil {return _aadb ;
};if _dccd .MediaBox ==nil {_dccd .MediaBox =_abebc ;};if _gge :=_aadd ._gbeg .AddPage (_dccd );_gge !=nil {return _gge ;};_ab .Slice (_bdab ,func (_bcfbc ,_acbc int )bool {return _bdab [_bcfbc ]._fgc < _bdab [_acbc ]._fgc });_ffg :=_abebc .Ury ;for _ ,_ggef :=range _bdab {_dfef :=_ggef ._bbe ;
_abb :=_aadd ._gbeg .NewRectangle (_dfef .Llx ,_ffg -_dfef .Lly ,_dfef .Urx -_dfef .Llx ,-(_dfef .Ury -_dfef .Lly ));_abb .SetFillColor (_fdge );_abb .SetBorderWidth (_ead );_abb .SetFillOpacity (_bcfb );if _eecg :=_aadd ._gbeg .Draw (_abb );_eecg !=nil {return nil ;
};};};_aadd ._gbeg .SetOutlineTree (_aadd ._fea .GetOutlineTree ());return nil ;};func _gaeb (_ggd ,_cbgbc string )[]int {if len (_cbgbc )==0{return nil ;};var _ecca []int ;for _aebe :=0;_aebe < len (_ggd );{_gbdc :=_bc .Index (_ggd [_aebe :],_cbgbc );
if _gbdc < 0{return _ecca ;};_ecca =append (_ecca ,_aebe +_gbdc );_aebe +=_gbdc +len (_cbgbc );};return _ecca ;};func _aaf (_cad *_e .ContentStreamOperations ,PdfObj _dd .PdfObject )(*_e .ContentStreamOperation ,int ,bool ){for _abgf ,_dbf :=range *_cad {_egd :=_dbf .Operand ;
if _egd =="\u0054\u006a"{_bdgd :=_dd .TraceToDirectObject (_dbf .Params [0]);if _bdgd ==PdfObj {return _dbf ,_abgf ,true ;};}else if _egd =="\u0054\u004a"{_agfe ,_bace :=_dd .GetArray (_dbf .Params [0]);if !_bace {return nil ,_abgf ,_bace ;};for _ ,_dega :=range _agfe .Elements (){if _dega ==PdfObj {return _dbf ,_abgf ,true ;
};};}else if _egd =="\u0022"{_bag :=_dd .TraceToDirectObject (_dbf .Params [2]);if _bag ==PdfObj {return _dbf ,_abgf ,true ;};}else if _egd =="\u0027"{_gbe :=_dd .TraceToDirectObject (_dbf .Params [0]);if _gbe ==PdfObj {return _dbf ,_abgf ,true ;};};};
return nil ,-1,false ;};func _ea (_bca *_e .ContentStreamOperations ,_cd map[_dd .PdfObject ][]localSpanMarks )error {for _ed ,_cb :=range _cd {if _ed ==nil {continue ;};_cf ,_ef ,_de :=_aaf (_bca ,_ed );if !_de {_c .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_ed ,_bca );
return nil ;};if _cf .Operand =="\u0054\u006a"{_fc :=_fgb (_cf ,_ed ,_cb );if _fc !=nil {return _fc ;};}else if _cf .Operand =="\u0054\u004a"{_cfd :=_cda (_cf ,_ed ,_cb );if _cfd !=nil {return _cfd ;};}else if _cf .Operand =="\u0027"||_cf .Operand =="\u0022"{_bg :=_ce (_bca ,_cf .Operand ,_ef );
if _bg !=nil {return _bg ;};_bg =_fgb (_cf ,_ed ,_cb );if _bg !=nil {return _bg ;};};};return nil ;};type placeHolders struct{_gd []int ;_df string ;_ge float64 ;};func _ce (_ec *_e .ContentStreamOperations ,_bf string ,_abe int )error {_cbg :=_e .ContentStreamOperations {};
var _dg _e .ContentStreamOperation ;for _gf ,_bef :=range *_ec {if _gf ==_abe {if _bf =="\u0027"{_gdf :=_e .ContentStreamOperation {Operand :"\u0054\u002a"};_cbg =append (_cbg ,&_gdf );_dg .Params =_bef .Params ;_dg .Operand ="\u0054\u006a";_cbg =append (_cbg ,&_dg );
}else if _bf =="\u0022"{_bce :=_bef .Params [:2];Tc ,Tw :=_bce [0],_bce [1];_bcf :=_e .ContentStreamOperation {Params :[]_dd .PdfObject {Tc },Operand :"\u0054\u0063"};_cbg =append (_cbg ,&_bcf );_bcf =_e .ContentStreamOperation {Params :[]_dd .PdfObject {Tw },Operand :"\u0054\u0077"};
_cbg =append (_cbg ,&_bcf );_dg .Params =[]_dd .PdfObject {_bef .Params [2]};_dg .Operand ="\u0054\u006a";_cbg =append (_cbg ,&_dg );};};_cbg =append (_cbg ,_bef );};*_ec =_cbg ;return nil ;};func _gece (_ddca []int ,_aba *_fb .TextMarkArray ,_fgdg string )(*_fb .TextMarkArray ,matchedBBox ,error ){_fbbc :=matchedBBox {};
_gcd :=_ddca [0];_ggaca :=_ddca [1];_agfdf :=len (_fgdg )-len (_bc .TrimLeft (_fgdg ,"\u0020"));_cca :=len (_fgdg )-len (_bc .TrimRight (_fgdg ,"\u0020\u000a"));_gcd =_gcd +_agfdf ;_ggaca =_ggaca -_cca ;_fgdg =_bc .Trim (_fgdg ,"\u0020\u000a");_edag ,_dgda :=_aba .RangeOffset (_gcd ,_ggaca );
if _dgda !=nil {return nil ,_fbbc ,_dgda ;};_gfgg ,_bde :=_edag .BBox ();if !_bde {return nil ,_fbbc ,_b .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_edag );
};_fbbc =matchedBBox {_fgc :_fgdg ,_bbe :_gfgg };return _edag ,_fbbc ,nil ;};type localSpanMarks struct{_efdg *_fb .TextMarkArray ;_gfa int ;_efca string ;};func _fcde (_feb *matchedIndex ,_cdbe [][]int )[]*matchedIndex {_ggb :=[]*matchedIndex {};_bcdbb :=_feb ._fdg ;
_egcf :=_bcdbb ;_ddbb :=_feb ._abcg ;_baee :=0;for _ ,_bfbd :=range _cdbe {_cgb :=_bfbd [0]-_bcdbb ;if _baee >=_cgb {continue ;};_ffag :=_ddbb [_baee :_cgb ];_aea :=&matchedIndex {_abcg :_ffag ,_fdg :_egcf ,_bea :_bfbd [0]};if len (_bc .TrimSpace (_ffag ))!=0{_ggb =append (_ggb ,_aea );
};_baee =_bfbd [1]-_bcdbb ;_egcf =_bcdbb +_baee ;};_acgc :=_ddbb [_baee :];_cgcf :=&matchedIndex {_abcg :_acgc ,_fdg :_egcf ,_bea :_feb ._bea };if len (_bc .TrimSpace (_acgc ))!=0{_ggb =append (_ggb ,_cgcf );};return _ggb ;};func _ecd (_abeb *_fb .TextMarkArray )*_d .PdfFont {_ ,_aed :=_bgd (_abeb );
_dgb :=_abeb .Elements ()[_aed ];_fde :=_dgb .Font ;return _fde ;};type regexMatcher struct{_fef RedactionTerm };func _bcaf (_bb []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_gg :=make (map[string ][]localSpanMarks );_dbb :=[]string {};for _ ,_abdd :=range _bb {_ddc :=_abdd ._efca ;
if _agb ,_bd :=_gg [_ddc ];_bd {_gg [_ddc ]=append (_agb ,_abdd );}else {_gg [_ddc ]=[]localSpanMarks {_abdd };_dbb =append (_dbb ,_ddc );};};return _gg ,_dbb ;};func (_gcb *Redactor )redactPage (_cedc *_e .ContentStreamOperations ,_ceb *_d .PdfPageResources )([]matchedBBox ,*_e .ContentStreamOperations ,error ){_cfg ,_egde :=_fb .NewFromContents (_cedc .String (),_ceb );
if _egde !=nil {return nil ,nil ,_egde ;};_eea ,_ ,_ ,_egde :=_cfg .ExtractPageText ();if _egde !=nil {return nil ,nil ,_egde ;};_cedc =_eea .GetContentStreamOps ();_cgc :=_eea .Marks ();_bgde :=_eea .Text ();_bgde ,_degb :=_bdaf (_bgde );_ffe :=[]matchedBBox {};
_cag :=make (map[_dd .PdfObject ][]localSpanMarks );_eaac :=[]*targetMap {};for _ ,_fgcg :=range _gcb ._fbg .Terms {_aeeg ,_egdf :=_gagb (_fgcg );if _egdf !=nil {return nil ,nil ,_egdf ;};_gfbe ,_egdf :=_aeeg .match (_bgde );if _egdf !=nil {return nil ,nil ,_egdf ;
};_gfbe =_bgb (_gfbe ,_degb );_eafg :=_badd (_gfbe );_eaac =append (_eaac ,_eafg ...);};_bgge (_eaac );for _ ,_bcac :=range _eaac {_bbbd :=_bcac ._dda ;_agfd :=_bcac ._bbeg ;_efdd :=[]matchedBBox {};for _ ,_cega :=range _agfd {_cdgb ,_gcag ,_aca :=_gece (_cega ,_cgc ,_bbbd );
if _aca !=nil {return nil ,nil ,_aca ;};_fec :=_dae (_cdgb );for _egb ,_bab :=range _fec {_gdbg :=localSpanMarks {_efdg :_bab ,_gfa :_egb ,_efca :_bbbd };_ebgc ,_ :=_bgd (_bab );if _gbdd ,_aafb :=_cag [_ebgc ];_aafb {_cag [_ebgc ]=append (_gbdd ,_gdbg );
}else {_cag [_ebgc ]=[]localSpanMarks {_gdbg };};};_efdd =append (_efdd ,_gcag );};_ffe =append (_ffe ,_efdd ...);};_egde =_ea (_cedc ,_cag );if _egde !=nil {return nil ,nil ,_egde ;};return _ffe ,_cedc ,nil ;};func _aa (_agc *_fb .TextMarkArray )int {_cde :=0;
_ac :=_agc .Elements ();if _ac [0].Text =="\u0020"{_cde ++;};if _ac [_agc .Len ()-1].Text =="\u0020"{_cde ++;};return _cde ;};func _aebf (_eaag []placeHolders )[]replacement {_cec :=[]replacement {};for _ ,_dde :=range _eaag {_cdec :=_dde ._gd ;_ebg :=_dde ._df ;
_dffd :=_dde ._ge ;for _ ,_abg :=range _cdec {_bgg :=replacement {_fg :_ebg ,_ag :_dffd ,_adf :_abg };_cec =append (_cec ,_bgg );};};_ab .Slice (_cec ,func (_ada ,_fbfa int )bool {return _cec [_ada ]._adf < _cec [_fbfa ]._adf });return _cec ;};func _badd (_cdb []*matchedIndex )[]*targetMap {_fff :=make (map[string ][][]int );
_cedeg :=[]*targetMap {};for _ ,_acgf :=range _cdb {_bfdg :=_acgf ._abcg ;_cbfc :=[]int {_acgf ._fdg ,_acgf ._bea };if _acfc ,_cge :=_fff [_bfdg ];_cge {_fff [_bfdg ]=append (_acfc ,_cbfc );}else {_fff [_bfdg ]=[][]int {_cbfc };};};for _cadb ,_cba :=range _fff {_fbgca :=&targetMap {_dda :_cadb ,_bbeg :_cba };
_cedeg =append (_cedeg ,_fbgca );};return _cedeg ;};func _ff (_aad localSpanMarks ,_gbg *_fb .TextMarkArray ,_ege *_d .PdfFont ,_bfcf ,_gcc string )([]_dd .PdfObject ,error ){_efc :=_bggb (_gbg );Tj ,_bec :=_agcb (_gbg );if _bec !=nil {return nil ,_bec ;
};_eeg :=len (_bfcf );_fe :=len (_efc );_aee :=-1;_gce :=_dd .MakeFloat (Tj );if _efc !=_gcc {_cfa :=_aad ._gfa ;if _cfa ==0{_aee =_bc .LastIndex (_bfcf ,_efc );}else {_aee =_bc .Index (_bfcf ,_efc );};}else {_aee =_bc .Index (_bfcf ,_efc );};_ebab :=_aee +_fe ;
_bbb :=[]_dd .PdfObject {};if _aee ==0&&_ebab ==_eeg {_bbb =append (_bbb ,_gce );}else if _aee ==0&&_ebab < _eeg {_afa :=_ade (_bfcf [_ebab :],_ege );_dbba :=_dd .MakeStringFromBytes (_afa );_bbb =append (_bbb ,_gce ,_dbba );}else if _aee > 0&&_ebab >=_eeg {_bcdb :=_ade (_bfcf [:_aee ],_ege );
_ceg :=_dd .MakeStringFromBytes (_bcdb );_bbb =append (_bbb ,_ceg ,_gce );}else if _aee > 0&&_ebab < _eeg {_dfe :=_ade (_bfcf [:_aee ],_ege );_gee :=_ade (_bfcf [_ebab :],_ege );_ebb :=_dd .MakeStringFromBytes (_dfe );_beca :=_dd .MakeString (string (_gee ));
_bbb =append (_bbb ,_ebb ,_gce ,_beca );};return _bbb ,nil ;};func _ffb (_ddbf *targetMap ,_gedf []int ){var _gfdf [][]int ;for _aag ,_fcc :=range _ddbf ._bbeg {if _afc (_aag ,_gedf ){continue ;};_gfdf =append (_gfdf ,_fcc );};_ddbf ._bbeg =_gfdf ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_ad .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_abf *Redactor )Write (writer _f .Writer )error {return _abf ._gbeg .Write (writer )};func _bggb (_dcgg *_fb .TextMarkArray )string {_fee :="";for _ ,_dfd :=range _dcgg .Elements (){_fee +=_dfd .Text ;};return _fee ;};func _bgb (_egbb []*matchedIndex ,_bfg [][]int )[]*matchedIndex {_cbdc :=[]*matchedIndex {};
for _ ,_agfc :=range _egbb {_fcf ,_cdcg :=_fcfg (_agfc ,_bfg );if _fcf {_egf :=_fcde (_agfc ,_cdcg );_cbdc =append (_cbdc ,_egf ...);}else {_cbdc =append (_cbdc ,_agfc );};};return _cbdc ;};func _bgd (_cfc *_fb .TextMarkArray )(_dd .PdfObject ,int ){var _ga _dd .PdfObject ;
_gb :=-1;for _cg ,_ba :=range _cfc .Elements (){_ga =_ba .DirectObject ;_gb =_cg ;if _ga !=nil {break ;};};return _ga ,_gb ;};func _agcb (_bcdg *_fb .TextMarkArray )(float64 ,error ){_ebga ,_degd :=_bcdg .BBox ();if !_degd {return 0.0,_b .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_bcdg );
};_edf :=_aa (_bcdg );_eaba :=0.0;_ ,_dfeb :=_bgd (_bcdg );_dcc :=_bcdg .Elements ()[_dfeb ];_bedf :=_dcc .Font ;if _edf > 0{_eaba =_cfe (_bedf ,_dcc );};_gdc :=(_ebga .Urx -_ebga .Llx );_gdc =_gdc +_eaba *float64 (_edf );Tj :=_gdd (_gdc ,_dcc .FontSize ,_dcc .Th );
return Tj ,nil ;};

// Redactor represents a Redactor object.
type Redactor struct{_fea *_d .PdfReader ;_fbg *RedactionOptions ;_gbeg *_ad .Creator ;_eag *RectangleProps ;};

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _ad .Color ;BorderWidth float64 ;FillOpacity float64 ;};func (_accf *regexMatcher )match (_befc string )([]*matchedIndex ,error ){_cac :=_accf ._fef .Pattern ;if _cac ==nil {return nil ,_be .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");
};var (_gbab =_cac .FindAllStringIndex (_befc ,-1);_feg []*matchedIndex ;);for _ ,_debc :=range _gbab {_feg =append (_feg ,&matchedIndex {_fdg :_debc [0],_bea :_debc [1],_abcg :_befc [_debc [0]:_debc [1]]});};return _feg ,nil ;};func _afgf (_adg string ,_gga []replacement ,_dgdb *_d .PdfFont )[]_dd .PdfObject {_aec :=[]_dd .PdfObject {};
_fad :=0;_fced :=_adg ;for _acg ,_egc :=range _gga {_deg :=_egc ._adf ;_gagd :=_egc ._ag ;_gfde :=_egc ._fg ;_fdd :=_dd .MakeFloat (_gagd );if _fad > _deg ||_deg ==-1{continue ;};_deb :=_adg [_fad :_deg ];_dfa :=_ade (_deb ,_dgdb );_gac :=_dd .MakeStringFromBytes (_dfa );
_aec =append (_aec ,_gac );_aec =append (_aec ,_fdd );_bda :=_deg +len (_gfde );_fced =_adg [_bda :];_fad =_bda ;if _acg ==len (_gga )-1{_dfa =_ade (_fced ,_dgdb );_gac =_dd .MakeStringFromBytes (_dfa );_aec =append (_aec ,_gac );};};return _aec ;};func _ade (_dcg string ,_adc *_d .PdfFont )[]byte {_bfc ,_dfce :=_adc .StringToCharcodeBytes (_dcg );
if _dfce !=0{_c .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_dcg ,_bfc );
};return _bfc ;};func _bgge (_abdb []*targetMap ){for _cfga ,_fbfac :=range _abdb {for _efe ,_gbc :=range _abdb {if _cfga !=_efe {_gdge ,_add :=_gcba (*_fbfac ,*_gbc );if _gdge {_ffb (_gbc ,_add );};};};};};type matchedIndex struct{_fdg int ;_bea int ;
_abcg string ;};func _gagb (_agfcb RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_fef :_agfcb },nil };type replacement struct{_fg string ;_ag float64 ;_adf int ;};func _fgb (_bae *_e .ContentStreamOperation ,_bdg _dd .PdfObject ,_eba []localSpanMarks )error {var _aefc *_dd .PdfObjectArray ;
_gdb ,_gfd :=_bcaf (_eba );if len (_gfd )==1{_ecde :=_gfd [0];_deeb :=_gdb [_ecde ];if len (_deeb )==1{_bbf :=_deeb [0];_eg :=_bbf ._efdg ;_adfb :=_ecd (_eg );_af ,_cbf :=_bee (_bdg ,_adfb );if _cbf !=nil {return _cbf ;};_fgd ,_cbf :=_ff (_bbf ,_eg ,_adfb ,_af ,_ecde );
if _cbf !=nil {return _cbf ;};_aefc =_dd .MakeArray (_fgd ...);}else {_eab :=_deeb [0]._efdg ;_bfd :=_ecd (_eab );_gdfg ,_gca :=_bee (_bdg ,_bfd );if _gca !=nil {return _gca ;};_ggc ,_gca :=_bed (_gdfg ,_deeb );if _gca !=nil {return _gca ;};_abc :=_aebf (_ggc );
_cbc :=_afgf (_gdfg ,_abc ,_bfd );_aefc =_dd .MakeArray (_cbc ...);};}else if len (_gfd )> 1{_caa :=_eba [0];_cede :=_caa ._efdg ;_ ,_dac :=_bgd (_cede );_eae :=_cede .Elements ()[_dac ];_ebd :=_eae .Font ;_dge ,_faf :=_bee (_bdg ,_ebd );if _faf !=nil {return _faf ;
};_agcf ,_faf :=_bed (_dge ,_eba );if _faf !=nil {return _faf ;};_bbfa :=_aebf (_agcf );_bga :=_afgf (_dge ,_bbfa ,_ebd );_aefc =_dd .MakeArray (_bga ...);};_bae .Params [0]=_aefc ;_bae .Operand ="\u0054\u004a";return nil ;};func _cfgb (_ccd *_fb .TextMarkArray ,_bdd int ,_adaf int )int {_bbfb :=_ccd .Elements ();
_bedd :=_bdd -1;_eed :=_bdd +1;_bdc :=-1;if _bedd >=0{_ccf :=_bbfb [_bedd ];_ffeg :=_ccf .ObjString ;_bdf :=len (_ffeg );_baed :=_ccf .Index ;if _baed +1< _bdf {_bdc =_bedd ;return _bdc ;};};if _eed < len (_bbfb ){_bece :=_bbfb [_eed ];_feec :=_bece .ObjString ;
if _feec [0]!=_bece .Text {_bdc =_eed ;return _bdc ;};};return _bdc ;};func _bed (_fbf string ,_bfb []localSpanMarks )([]placeHolders ,error ){_ggf :="";_bgdb :=[]placeHolders {};for _ffa ,_ggcg :=range _bfb {_aeb :=_ggcg ._efdg ;_egg :=_ggcg ._efca ;_gec :=_bggb (_aeb );
_fdef ,_fca :=_agcb (_aeb );if _fca !=nil {return nil ,_fca ;};if _gec !=_ggf {var _def []int ;if _ffa ==0&&_egg !=_gec {_ged :=_bc .Index (_fbf ,_gec );_def =[]int {_ged };}else if _ffa ==len (_bfb )-1{_afg :=_bc .LastIndex (_fbf ,_gec );_def =[]int {_afg };
}else {_def =_gaeb (_fbf ,_gec );};_eec :=placeHolders {_gd :_def ,_df :_gec ,_ge :_fdef };_bgdb =append (_bgdb ,_eec );};_ggf =_gec ;};return _bgdb ,nil ;};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_d .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_fea :reader ,_fbg :opts ,_gbeg :_ad .New (),_eag :rectProps };};func _afc (_efb int ,_cbd []int )bool {for _ ,_cbfe :=range _cbd {if _cbfe ==_efb {return true ;
};};return false ;};func _cda (_ee *_e .ContentStreamOperation ,_bcef _dd .PdfObject ,_bac []localSpanMarks )error {_cbgb ,_cee :=_dd .GetArray (_ee .Params [0]);_eaa :=[]_dd .PdfObject {};if !_cee {_c .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_ee );
return _b .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_ee );
};_dgd ,_gda :=_bcaf (_bac );if len (_gda )==1{_fa :=_gda [0];_dff :=_dgd [_fa ];if len (_dff )==1{_dee :=_dff [0];_dfc :=_dee ._efdg ;_gba :=_ecd (_dfc );_bfe ,_fbb :=_bee (_bcef ,_gba );if _fbb !=nil {return _fbb ;};_abd ,_fbb :=_ff (_dee ,_dfc ,_gba ,_bfe ,_fa );
if _fbb !=nil {return _fbb ;};for _ ,_gae :=range _cbgb .Elements (){if _gae ==_bcef {_eaa =append (_eaa ,_abd ...);}else {_eaa =append (_eaa ,_gae );};};}else {_ae :=_dff [0]._efdg ;_dc :=_ecd (_ae );_dce ,_efd :=_bee (_bcef ,_dc );if _efd !=nil {return _efd ;
};_eb ,_efd :=_bed (_dce ,_dff );if _efd !=nil {return _efd ;};_ecc :=_aebf (_eb );_efdb :=_afgf (_dce ,_ecc ,_dc );for _ ,_aae :=range _cbgb .Elements (){if _aae ==_bcef {_eaa =append (_eaa ,_efdb ...);}else {_eaa =append (_eaa ,_aae );};};};_ee .Params [0]=_dd .MakeArray (_eaa ...);
}else if len (_gda )> 1{_cc :=_bac [0];_fd :=_cc ._efdg ;_ ,_bcb :=_bgd (_fd );_ca :=_fd .Elements ()[_bcb ];_cff :=_ca .Font ;_aef ,_eda :=_bee (_bcef ,_cff );if _eda !=nil {return _eda ;};_acb ,_eda :=_bed (_aef ,_bac );if _eda !=nil {return _eda ;};
_cdaa :=_aebf (_acb );_acf :=_afgf (_aef ,_cdaa ,_cff );for _ ,_ddb :=range _cbgb .Elements (){if _ddb ==_bcef {_eaa =append (_eaa ,_acf ...);}else {_eaa =append (_eaa ,_ddb );};};_ee .Params [0]=_dd .MakeArray (_eaa ...);};return nil ;};

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_a .Regexp ;};func _bdaf (_dcd string )(string ,[][]int ){_ecg :=_a .MustCompile ("\u005c\u006e");_ebdc :=_ecg .FindAllStringIndex (_dcd ,-1);_gaec :=_ecg .ReplaceAllString (_dcd ,"\u0020");return _gaec ,_ebdc ;};func _cfe (_da *_d .PdfFont ,_gfg _fb .TextMark )float64 {_db :=0.001;
_fga :=_gfg .Th /100;if _da .Subtype ()=="\u0054\u0079\u0070e\u0033"{_db =1;};_gag ,_gdg :=_da .GetRuneMetrics (' ');if !_gdg {_gag ,_gdg =_da .GetCharMetrics (32);};if !_gdg {_gag ,_ =_d .DefaultFont ().GetRuneMetrics (' ');};_fce :=_db *((_gag .Wx *_gfg .FontSize +_gfg .Tc +_gfg .Tw )/_fga );
return _fce ;};func _fcfg (_aeab *matchedIndex ,_gecb [][]int )(bool ,[][]int ){_dcda :=[][]int {};for _ ,_ccc :=range _gecb {if _aeab ._fdg < _ccc [0]&&_aeab ._bea > _ccc [1]{_dcda =append (_dcda ,_ccc );};};return len (_dcda )> 0,_dcda ;};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;};